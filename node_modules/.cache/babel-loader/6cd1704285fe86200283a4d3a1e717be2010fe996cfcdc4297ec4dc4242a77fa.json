{"ast":null,"code":"import pb from 'protobufjs';\nvar Reader = pb.Reader;\n// monkey patch the reader to add native bigint support\nvar methods = ['uint64', 'int64', 'sint64', 'fixed64', 'sfixed64'];\nmethods.forEach(function (method) {\n  // @ts-expect-error\n  var original = Reader.prototype[method];\n  // @ts-expect-error\n  Reader.prototype[method] = function () {\n    return BigInt(original.call(this).toString());\n  };\n});\nexport function decodeMessage(buf, codec) {\n  var reader = Reader.create(buf instanceof Uint8Array ? buf : buf.subarray());\n  // @ts-expect-error\n  return codec.decode(reader);\n}","map":{"version":3,"names":["pb","Reader","methods","forEach","method","original","prototype","BigInt","call","toString","decodeMessage","buf","codec","reader","create","Uint8Array","subarray","decode"],"sources":["/Users/apple/Documents/treasure/node_modules/protons-runtime/src/decode.ts"],"sourcesContent":["import type { Uint8ArrayList } from 'uint8arraylist'\nimport type { Codec } from './codec.js'\nimport pb from 'protobufjs'\n\nconst Reader = pb.Reader\n\n// monkey patch the reader to add native bigint support\nconst methods = [\n  'uint64', 'int64', 'sint64', 'fixed64', 'sfixed64'\n]\nmethods.forEach(method => {\n  // @ts-expect-error\n  const original = Reader.prototype[method]\n  // @ts-expect-error\n  Reader.prototype[method] = function (): bigint {\n    return BigInt(original.call(this).toString())\n  }\n})\n\nexport function decodeMessage <T> (buf: Uint8Array | Uint8ArrayList, codec: Codec<T>): T {\n  const reader = Reader.create(buf instanceof Uint8Array ? buf : buf.subarray())\n\n  // @ts-expect-error\n  return codec.decode(reader)\n}\n"],"mappings":"AAEA,OAAOA,EAAE,MAAM,YAAY;AAE3B,IAAMC,MAAM,GAAGD,EAAE,CAACC,MAAM;AAExB;AACA,IAAMC,OAAO,GAAG,CACd,QAAQ,EAAE,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,UAAU,CACnD;AACDA,OAAO,CAACC,OAAO,CAAC,UAAAC,MAAM,EAAG;EACvB;EACA,IAAMC,QAAQ,GAAGJ,MAAM,CAACK,SAAS,CAACF,MAAM,CAAC;EACzC;EACAH,MAAM,CAACK,SAAS,CAACF,MAAM,CAAC,GAAG;IACzB,OAAOG,MAAM,CAACF,QAAQ,CAACG,IAAI,CAAC,IAAI,CAAC,CAACC,QAAQ,EAAE,CAAC;EAC/C,CAAC;AACH,CAAC,CAAC;AAEF,OAAM,SAAUC,aAAaA,CAAMC,GAAgC,EAAEC,KAAe;EAClF,IAAMC,MAAM,GAAGZ,MAAM,CAACa,MAAM,CAACH,GAAG,YAAYI,UAAU,GAAGJ,GAAG,GAAGA,GAAG,CAACK,QAAQ,EAAE,CAAC;EAE9E;EACA,OAAOJ,KAAK,CAACK,MAAM,CAACJ,MAAM,CAAC;AAC7B"},"metadata":{},"sourceType":"module","externalDependencies":[]}