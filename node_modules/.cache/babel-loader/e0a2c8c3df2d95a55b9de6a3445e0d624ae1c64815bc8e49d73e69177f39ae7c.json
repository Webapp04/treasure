{"ast":null,"code":"import _createForOfIteratorHelper from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _regeneratorRuntime from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _classCallCheck from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _asyncIterator from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/asyncIterator.js\";\nimport { logger } from '@libp2p/logger';\nimport { EventEmitter } from '@libp2p/interfaces/events';\nimport { PeerStoreAddressBook } from './address-book.js';\nimport { PeerStoreKeyBook } from './key-book.js';\nimport { PeerStoreMetadataBook } from './metadata-book.js';\nimport { PeerStoreProtoBook } from './proto-book.js';\nimport { PersistentStore } from './store.js';\nimport { Components } from '@libp2p/components';\nimport errCode from 'err-code';\nimport { Tags } from './pb/tags.js';\nvar log = logger('libp2p:peer-store');\n/**\n * An implementation of PeerStore that stores data in a Datastore\n */\nexport var PersistentPeerStore = /*#__PURE__*/function (_EventEmitter) {\n  _inherits(PersistentPeerStore, _EventEmitter);\n  var _super = _createSuper(PersistentPeerStore);\n  function PersistentPeerStore() {\n    var _this;\n    var init = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    _classCallCheck(this, PersistentPeerStore);\n    _this = _super.call(this);\n    _this.components = new Components();\n    _this.store = new PersistentStore();\n    _this.addressBook = new PeerStoreAddressBook(_this.dispatchEvent.bind(_assertThisInitialized(_this)), _this.store, init.addressFilter);\n    _this.keyBook = new PeerStoreKeyBook(_this.dispatchEvent.bind(_assertThisInitialized(_this)), _this.store);\n    _this.metadataBook = new PeerStoreMetadataBook(_this.dispatchEvent.bind(_assertThisInitialized(_this)), _this.store);\n    _this.protoBook = new PeerStoreProtoBook(_this.dispatchEvent.bind(_assertThisInitialized(_this)), _this.store);\n    return _this;\n  }\n  _createClass(PersistentPeerStore, [{\n    key: \"init\",\n    value: function init(components) {\n      this.components = components;\n      this.store.init(components);\n    }\n  }, {\n    key: \"forEach\",\n    value: function () {\n      var _forEach = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(fn) {\n        var release, _iteratorAbruptCompletion, _didIteratorError, _iteratorError, _iterator, _step, peer;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              log.trace('getPeers await read lock');\n              _context.next = 3;\n              return this.store.lock.readLock();\n            case 3:\n              release = _context.sent;\n              log.trace('getPeers got read lock');\n              _context.prev = 5;\n              _iteratorAbruptCompletion = false;\n              _didIteratorError = false;\n              _context.prev = 8;\n              _iterator = _asyncIterator(this.store.all());\n            case 10:\n              _context.next = 12;\n              return _iterator.next();\n            case 12:\n              if (!(_iteratorAbruptCompletion = !(_step = _context.sent).done)) {\n                _context.next = 20;\n                break;\n              }\n              peer = _step.value;\n              if (!peer.id.equals(this.components.getPeerId())) {\n                _context.next = 16;\n                break;\n              }\n              return _context.abrupt(\"continue\", 17);\n            case 16:\n              fn(peer);\n            case 17:\n              _iteratorAbruptCompletion = false;\n              _context.next = 10;\n              break;\n            case 20:\n              _context.next = 26;\n              break;\n            case 22:\n              _context.prev = 22;\n              _context.t0 = _context[\"catch\"](8);\n              _didIteratorError = true;\n              _iteratorError = _context.t0;\n            case 26:\n              _context.prev = 26;\n              _context.prev = 27;\n              if (!(_iteratorAbruptCompletion && _iterator.return != null)) {\n                _context.next = 31;\n                break;\n              }\n              _context.next = 31;\n              return _iterator.return();\n            case 31:\n              _context.prev = 31;\n              if (!_didIteratorError) {\n                _context.next = 34;\n                break;\n              }\n              throw _iteratorError;\n            case 34:\n              return _context.finish(31);\n            case 35:\n              return _context.finish(26);\n            case 36:\n              _context.prev = 36;\n              log.trace('getPeers release read lock');\n              release();\n              return _context.finish(36);\n            case 40:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[5,, 36, 40], [8, 22, 26, 36], [27,, 31, 35]]);\n      }));\n      function forEach(_x) {\n        return _forEach.apply(this, arguments);\n      }\n      return forEach;\n    }()\n  }, {\n    key: \"all\",\n    value: function () {\n      var _all = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var output;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              output = [];\n              _context2.next = 3;\n              return this.forEach(function (peer) {\n                output.push(peer);\n              });\n            case 3:\n              return _context2.abrupt(\"return\", output);\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function all() {\n        return _all.apply(this, arguments);\n      }\n      return all;\n    }()\n    /**\n     * Delete the information of the given peer in every book\n     */\n  }, {\n    key: \"delete\",\n    value: function () {\n      var _delete2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(peerId) {\n        var release;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              log.trace('delete await write lock');\n              _context3.next = 3;\n              return this.store.lock.writeLock();\n            case 3:\n              release = _context3.sent;\n              log.trace('delete got write lock');\n              _context3.prev = 5;\n              _context3.next = 8;\n              return this.store.delete(peerId);\n            case 8:\n              _context3.prev = 8;\n              log.trace('delete release write lock');\n              release();\n              return _context3.finish(8);\n            case 12:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this, [[5,, 8, 12]]);\n      }));\n      function _delete(_x2) {\n        return _delete2.apply(this, arguments);\n      }\n      return _delete;\n    }()\n    /**\n     * Get the stored information of a given peer\n     */\n  }, {\n    key: \"get\",\n    value: function () {\n      var _get = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(peerId) {\n        var release;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              log.trace('get await read lock');\n              _context4.next = 3;\n              return this.store.lock.readLock();\n            case 3:\n              release = _context4.sent;\n              log.trace('get got read lock');\n              _context4.prev = 5;\n              _context4.next = 8;\n              return this.store.load(peerId);\n            case 8:\n              return _context4.abrupt(\"return\", _context4.sent);\n            case 9:\n              _context4.prev = 9;\n              log.trace('get release read lock');\n              release();\n              return _context4.finish(9);\n            case 13:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this, [[5,, 9, 13]]);\n      }));\n      function get(_x3) {\n        return _get.apply(this, arguments);\n      }\n      return get;\n    }()\n    /**\n     * Returns true if we have a record of the peer\n     */\n  }, {\n    key: \"has\",\n    value: function () {\n      var _has = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(peerId) {\n        var release;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              log.trace('has await read lock');\n              _context5.next = 3;\n              return this.store.lock.readLock();\n            case 3:\n              release = _context5.sent;\n              log.trace('has got read lock');\n              _context5.prev = 5;\n              _context5.next = 8;\n              return this.store.has(peerId);\n            case 8:\n              return _context5.abrupt(\"return\", _context5.sent);\n            case 9:\n              _context5.prev = 9;\n              log.trace('has release read lock');\n              release();\n              return _context5.finish(9);\n            case 13:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, this, [[5,, 9, 13]]);\n      }));\n      function has(_x4) {\n        return _has.apply(this, arguments);\n      }\n      return has;\n    }()\n  }, {\n    key: \"tagPeer\",\n    value: function () {\n      var _tagPeer = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(peerId, tag) {\n        var _options$value, _options$ttl;\n        var options,\n          providedValue,\n          value,\n          ttl,\n          buf,\n          tags,\n          _iterator2,\n          _step2,\n          t,\n          _args6 = arguments;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              options = _args6.length > 2 && _args6[2] !== undefined ? _args6[2] : {};\n              providedValue = (_options$value = options.value) !== null && _options$value !== void 0 ? _options$value : 0;\n              value = Math.round(providedValue);\n              ttl = (_options$ttl = options.ttl) !== null && _options$ttl !== void 0 ? _options$ttl : undefined;\n              if (!(value !== providedValue || value < 0 || value > 100)) {\n                _context6.next = 6;\n                break;\n              }\n              throw errCode(new Error('Tag value must be between 0-100'), 'ERR_TAG_VALUE_OUT_OF_BOUNDS');\n            case 6:\n              _context6.next = 8;\n              return this.metadataBook.getValue(peerId, 'tags');\n            case 8:\n              buf = _context6.sent;\n              tags = [];\n              if (buf != null) {\n                tags = Tags.decode(buf).tags;\n              }\n              _iterator2 = _createForOfIteratorHelper(tags);\n              _context6.prev = 12;\n              _iterator2.s();\n            case 14:\n              if ((_step2 = _iterator2.n()).done) {\n                _context6.next = 20;\n                break;\n              }\n              t = _step2.value;\n              if (!(t.name === tag)) {\n                _context6.next = 18;\n                break;\n              }\n              throw errCode(new Error('Peer already tagged'), 'ERR_DUPLICATE_TAG');\n            case 18:\n              _context6.next = 14;\n              break;\n            case 20:\n              _context6.next = 25;\n              break;\n            case 22:\n              _context6.prev = 22;\n              _context6.t0 = _context6[\"catch\"](12);\n              _iterator2.e(_context6.t0);\n            case 25:\n              _context6.prev = 25;\n              _iterator2.f();\n              return _context6.finish(25);\n            case 28:\n              tags.push({\n                name: tag,\n                value: value,\n                expiry: ttl == null ? undefined : BigInt(Date.now() + ttl)\n              });\n              _context6.next = 31;\n              return this.metadataBook.setValue(peerId, 'tags', Tags.encode({\n                tags: tags\n              }).subarray());\n            case 31:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6, this, [[12, 22, 25, 28]]);\n      }));\n      function tagPeer(_x5, _x6) {\n        return _tagPeer.apply(this, arguments);\n      }\n      return tagPeer;\n    }()\n  }, {\n    key: \"unTagPeer\",\n    value: function () {\n      var _unTagPeer = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(peerId, tag) {\n        var buf, tags;\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.next = 2;\n              return this.metadataBook.getValue(peerId, 'tags');\n            case 2:\n              buf = _context7.sent;\n              tags = [];\n              if (buf != null) {\n                tags = Tags.decode(buf).tags;\n              }\n              tags = tags.filter(function (t) {\n                return t.name !== tag;\n              });\n              _context7.next = 8;\n              return this.metadataBook.setValue(peerId, 'tags', Tags.encode({\n                tags: tags\n              }).subarray());\n            case 8:\n            case \"end\":\n              return _context7.stop();\n          }\n        }, _callee7, this);\n      }));\n      function unTagPeer(_x7, _x8) {\n        return _unTagPeer.apply(this, arguments);\n      }\n      return unTagPeer;\n    }()\n  }, {\n    key: \"getTags\",\n    value: function () {\n      var _getTags = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(peerId) {\n        var buf, tags, now, unexpiredTags;\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.next = 2;\n              return this.metadataBook.getValue(peerId, 'tags');\n            case 2:\n              buf = _context8.sent;\n              tags = [];\n              if (buf != null) {\n                tags = Tags.decode(buf).tags;\n              }\n              now = BigInt(Date.now());\n              unexpiredTags = tags.filter(function (tag) {\n                return tag.expiry == null || tag.expiry > now;\n              });\n              if (!(unexpiredTags.length !== tags.length)) {\n                _context8.next = 10;\n                break;\n              }\n              _context8.next = 10;\n              return this.metadataBook.setValue(peerId, 'tags', Tags.encode({\n                tags: unexpiredTags\n              }).subarray());\n            case 10:\n              return _context8.abrupt(\"return\", unexpiredTags.map(function (t) {\n                var _t$value;\n                return {\n                  name: t.name,\n                  value: (_t$value = t.value) !== null && _t$value !== void 0 ? _t$value : 0\n                };\n              }));\n            case 11:\n            case \"end\":\n              return _context8.stop();\n          }\n        }, _callee8, this);\n      }));\n      function getTags(_x9) {\n        return _getTags.apply(this, arguments);\n      }\n      return getTags;\n    }()\n  }]);\n  return PersistentPeerStore;\n}(EventEmitter);","map":{"version":3,"names":["logger","EventEmitter","PeerStoreAddressBook","PeerStoreKeyBook","PeerStoreMetadataBook","PeerStoreProtoBook","PersistentStore","Components","errCode","Tags","log","PersistentPeerStore","_EventEmitter","_inherits","_super","_createSuper","_this","init","arguments","length","undefined","_classCallCheck","call","components","store","addressBook","dispatchEvent","bind","_assertThisInitialized","addressFilter","keyBook","metadataBook","protoBook","_createClass","key","value","_forEach","_asyncToGenerator","_regeneratorRuntime","mark","_callee","fn","release","_iteratorAbruptCompletion","_didIteratorError","_iteratorError","_iterator","_step","peer","wrap","_callee$","_context","prev","next","trace","lock","readLock","sent","_asyncIterator","all","done","id","equals","getPeerId","abrupt","t0","return","finish","stop","forEach","_x","apply","_all","_callee2","output","_callee2$","_context2","push","_delete2","_callee3","peerId","_callee3$","_context3","writeLock","delete","_delete","_x2","_get","_callee4","_callee4$","_context4","load","get","_x3","_has","_callee5","_callee5$","_context5","has","_x4","_tagPeer","_callee6","tag","_options$value","_options$ttl","options","providedValue","ttl","buf","tags","_iterator2","_step2","t","_args6","_callee6$","_context6","Math","round","Error","getValue","decode","_createForOfIteratorHelper","s","n","name","e","f","expiry","BigInt","Date","now","setValue","encode","subarray","tagPeer","_x5","_x6","_unTagPeer","_callee7","_callee7$","_context7","filter","unTagPeer","_x7","_x8","_getTags","_callee8","unexpiredTags","_callee8$","_context8","map","_t$value","getTags","_x9"],"sources":["/Users/apple/Documents/treasure/node_modules/@libp2p/peer-store/src/index.ts"],"sourcesContent":["import { logger } from '@libp2p/logger'\nimport { EventEmitter } from '@libp2p/interfaces/events'\nimport { PeerStoreAddressBook } from './address-book.js'\nimport { PeerStoreKeyBook } from './key-book.js'\nimport { PeerStoreMetadataBook } from './metadata-book.js'\nimport { PeerStoreProtoBook } from './proto-book.js'\nimport { PersistentStore, Store } from './store.js'\nimport type { PeerStore, AddressBook, KeyBook, MetadataBook, ProtoBook, PeerStoreEvents, PeerStoreInit, Peer, TagOptions } from '@libp2p/interface-peer-store'\nimport type { PeerId } from '@libp2p/interface-peer-id'\nimport { Components, Initializable } from '@libp2p/components'\nimport errCode from 'err-code'\nimport { Tag, Tags } from './pb/tags.js'\n\nconst log = logger('libp2p:peer-store')\n\n/**\n * An implementation of PeerStore that stores data in a Datastore\n */\nexport class PersistentPeerStore extends EventEmitter<PeerStoreEvents> implements PeerStore, Initializable {\n  public addressBook: AddressBook\n  public keyBook: KeyBook\n  public metadataBook: MetadataBook\n  public protoBook: ProtoBook\n\n  private components: Components = new Components()\n  private readonly store: Store\n\n  constructor (init: PeerStoreInit = {}) {\n    super()\n\n    this.store = new PersistentStore()\n    this.addressBook = new PeerStoreAddressBook(this.dispatchEvent.bind(this), this.store, init.addressFilter)\n    this.keyBook = new PeerStoreKeyBook(this.dispatchEvent.bind(this), this.store)\n    this.metadataBook = new PeerStoreMetadataBook(this.dispatchEvent.bind(this), this.store)\n    this.protoBook = new PeerStoreProtoBook(this.dispatchEvent.bind(this), this.store)\n  }\n\n  init (components: Components) {\n    this.components = components\n    ;(this.store as PersistentStore).init(components)\n  }\n\n  async forEach (fn: (peer: Peer) => void) {\n    log.trace('getPeers await read lock')\n    const release = await this.store.lock.readLock()\n    log.trace('getPeers got read lock')\n\n    try {\n      for await (const peer of this.store.all()) {\n        if (peer.id.equals(this.components.getPeerId())) {\n          // Skip self peer if present\n          continue\n        }\n\n        fn(peer)\n      }\n    } finally {\n      log.trace('getPeers release read lock')\n      release()\n    }\n  }\n\n  async all (): Promise<Peer[]> {\n    const output: Peer[] = []\n\n    await this.forEach(peer => {\n      output.push(peer)\n    })\n\n    return output\n  }\n\n  /**\n   * Delete the information of the given peer in every book\n   */\n  async delete (peerId: PeerId) {\n    log.trace('delete await write lock')\n    const release = await this.store.lock.writeLock()\n    log.trace('delete got write lock')\n\n    try {\n      await this.store.delete(peerId)\n    } finally {\n      log.trace('delete release write lock')\n      release()\n    }\n  }\n\n  /**\n   * Get the stored information of a given peer\n   */\n  async get (peerId: PeerId) {\n    log.trace('get await read lock')\n    const release = await this.store.lock.readLock()\n    log.trace('get got read lock')\n\n    try {\n      return await this.store.load(peerId)\n    } finally {\n      log.trace('get release read lock')\n      release()\n    }\n  }\n\n  /**\n   * Returns true if we have a record of the peer\n   */\n  async has (peerId: PeerId) {\n    log.trace('has await read lock')\n    const release = await this.store.lock.readLock()\n    log.trace('has got read lock')\n\n    try {\n      return await this.store.has(peerId)\n    } finally {\n      log.trace('has release read lock')\n      release()\n    }\n  }\n\n  async tagPeer (peerId: PeerId, tag: string, options: TagOptions = {}) {\n    const providedValue = options.value ?? 0\n    const value = Math.round(providedValue)\n    const ttl = options.ttl ?? undefined\n\n    if (value !== providedValue || value < 0 || value > 100) {\n      throw errCode(new Error('Tag value must be between 0-100'), 'ERR_TAG_VALUE_OUT_OF_BOUNDS')\n    }\n\n    const buf = await this.metadataBook.getValue(peerId, 'tags')\n    let tags: Tag[] = []\n\n    if (buf != null) {\n      tags = Tags.decode(buf).tags\n    }\n\n    for (const t of tags) {\n      if (t.name === tag) {\n        throw errCode(new Error('Peer already tagged'), 'ERR_DUPLICATE_TAG')\n      }\n    }\n\n    tags.push({\n      name: tag,\n      value,\n      expiry: ttl == null ? undefined : BigInt(Date.now() + ttl)\n    })\n\n    await this.metadataBook.setValue(peerId, 'tags', Tags.encode({ tags }).subarray())\n  }\n\n  async unTagPeer (peerId: PeerId, tag: string) {\n    const buf = await this.metadataBook.getValue(peerId, 'tags')\n    let tags: Tag[] = []\n\n    if (buf != null) {\n      tags = Tags.decode(buf).tags\n    }\n\n    tags = tags.filter(t => t.name !== tag)\n\n    await this.metadataBook.setValue(peerId, 'tags', Tags.encode({ tags }).subarray())\n  }\n\n  async getTags (peerId: PeerId) {\n    const buf = await this.metadataBook.getValue(peerId, 'tags')\n    let tags: Tag[] = []\n\n    if (buf != null) {\n      tags = Tags.decode(buf).tags\n    }\n\n    const now = BigInt(Date.now())\n    const unexpiredTags = tags.filter(tag => tag.expiry == null || tag.expiry > now)\n\n    if (unexpiredTags.length !== tags.length) {\n      // remove any expired tags\n      await this.metadataBook.setValue(peerId, 'tags', Tags.encode({ tags: unexpiredTags }).subarray())\n    }\n\n    return unexpiredTags.map(t => ({\n      name: t.name,\n      value: t.value ?? 0\n    }))\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}