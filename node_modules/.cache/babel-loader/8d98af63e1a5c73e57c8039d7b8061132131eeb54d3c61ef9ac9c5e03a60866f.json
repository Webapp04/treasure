{"ast":null,"code":"import _regeneratorRuntime from\"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import AirdropApi from\"api/AirdropApi\";import{useContractNFKeyWithSigner,useContractSmarterCoinWithSigner}from\"hooks/blockchain/useHandleContracts\";import{useDispatch,useSelector}from\"react-redux\";import ACTIONS from\"redux/action\";import{selectNftSelected}from\"redux/slice/nftSlice\";import{selectUser}from\"redux/slice/userSlice\";export default function useApproveSMRTR(){var dispatch=useDispatch();var user=useSelector(selectUser);var nftSelected=useSelector(selectNftSelected);var handleContractNFKeyWithSigner=useContractNFKeyWithSigner();var handleContractSmarterCoinWithSigner=useContractSmarterCoinWithSigner();var approveSMRTR=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var contractNFKeyWithSigner,contractSmarterCoinWithSigner,amountUpgradeKey;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(nftSelected!==null&&nftSelected!==void 0&&nftSelected.tier){_context2.next=2;break;}return _context2.abrupt(\"return\");case 2:_context2.next=4;return handleContractNFKeyWithSigner;case 4:contractNFKeyWithSigner=_context2.sent;_context2.next=7;return handleContractSmarterCoinWithSigner;case 7:contractSmarterCoinWithSigner=_context2.sent;amountUpgradeKey=contractNFKeyWithSigner.getAmountUpgradeKey(+(nftSelected===null||nftSelected===void 0?void 0:nftSelected.tier)).then(function(tx){return tx===null||tx===void 0?void 0:tx._hex;});if(amountUpgradeKey){_context2.next=11;break;}return _context2.abrupt(\"return\");case 11:return _context2.abrupt(\"return\",contractSmarterCoinWithSigner.approve(process.env.REACT_APP_NFKEY_ADDRESS,amountUpgradeKey).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(tx){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:new AirdropApi().logger({wallet_id:user===null||user===void 0?void 0:user.wallet_id,type:\"PENDING\",action:\"approveSMRTR\",description:\"approveSMRTR\",tx:JSON.stringify(tx)});_context.next=3;return tx.wait();case 3:ACTIONS.SET_TRANSANCTION_HASH(dispatch,tx===null||tx===void 0?void 0:tx.hash);return _context.abrupt(\"return\",true);case 5:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}()).catch(function(err){new AirdropApi().logger({wallet_id:user===null||user===void 0?void 0:user.wallet_id,type:\"ERROR\",action:\"approveSMRTR\",error:JSON.stringify(err)});throw err;}));case 12:case\"end\":return _context2.stop();}},_callee2);}));return function approveSMRTR(){return _ref.apply(this,arguments);};}();return{approveSMRTR:approveSMRTR};}","map":{"version":3,"names":["AirdropApi","useContractNFKeyWithSigner","useContractSmarterCoinWithSigner","useDispatch","useSelector","ACTIONS","selectNftSelected","selectUser","useApproveSMRTR","dispatch","user","nftSelected","handleContractNFKeyWithSigner","handleContractSmarterCoinWithSigner","approveSMRTR","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","contractNFKeyWithSigner","contractSmarterCoinWithSigner","amountUpgradeKey","wrap","_callee2$","_context2","prev","next","tier","abrupt","sent","getAmountUpgradeKey","then","tx","_hex","approve","process","env","REACT_APP_NFKEY_ADDRESS","_ref2","_callee","_callee$","_context","logger","wallet_id","type","action","description","JSON","stringify","wait","SET_TRANSANCTION_HASH","hash","stop","_x","apply","arguments","catch","err","error"],"sources":["/Users/apple/Documents/treasure/src/hooks/nft/useApproveSMRTR.js"],"sourcesContent":["import AirdropApi from \"api/AirdropApi\";\nimport {\n  useContractNFKeyWithSigner,\n  useContractSmarterCoinWithSigner,\n} from \"hooks/blockchain/useHandleContracts\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport ACTIONS from \"redux/action\";\nimport { selectNftSelected } from \"redux/slice/nftSlice\";\nimport { selectUser } from \"redux/slice/userSlice\";\n\nexport default function useApproveSMRTR() {\n  const dispatch = useDispatch();\n  const user = useSelector(selectUser);\n  const nftSelected = useSelector(selectNftSelected);\n  const handleContractNFKeyWithSigner = useContractNFKeyWithSigner();\n  const handleContractSmarterCoinWithSigner =\n    useContractSmarterCoinWithSigner();\n\n  const approveSMRTR = async () => {\n    if (!nftSelected?.tier) return;\n    const contractNFKeyWithSigner = await handleContractNFKeyWithSigner;\n    const contractSmarterCoinWithSigner =\n      await handleContractSmarterCoinWithSigner;\n\n    const amountUpgradeKey = contractNFKeyWithSigner\n      .getAmountUpgradeKey(+nftSelected?.tier)\n      .then((tx) => tx?._hex);\n    if (!amountUpgradeKey) return;\n\n    return contractSmarterCoinWithSigner\n      .approve(process.env.REACT_APP_NFKEY_ADDRESS, amountUpgradeKey)\n      .then(async (tx) => {\n        new AirdropApi().logger({\n          wallet_id: user?.wallet_id,\n          type: \"PENDING\",\n          action: \"approveSMRTR\",\n          description: \"approveSMRTR\",\n          tx: JSON.stringify(tx),\n        });\n\n        await tx.wait();\n        ACTIONS.SET_TRANSANCTION_HASH(dispatch, tx?.hash);\n        return true;\n      })\n      .catch((err) => {\n        new AirdropApi().logger({\n          wallet_id: user?.wallet_id,\n          type: \"ERROR\",\n          action: \"approveSMRTR\",\n          error: JSON.stringify(err),\n        });\n\n        throw err;\n      });\n  };\n  return { approveSMRTR };\n}\n"],"mappings":"0PAAA,MAAO,CAAAA,UAAU,KAAM,gBAAgB,CACvC,OACEC,0BAA0B,CAC1BC,gCAAgC,KAC3B,qCAAqC,CAC5C,OAASC,WAAW,CAAEC,WAAW,KAAQ,aAAa,CACtD,MAAO,CAAAC,OAAO,KAAM,cAAc,CAClC,OAASC,iBAAiB,KAAQ,sBAAsB,CACxD,OAASC,UAAU,KAAQ,uBAAuB,CAElD,cAAe,SAAS,CAAAC,eAAeA,CAAA,CAAG,CACxC,GAAM,CAAAC,QAAQ,CAAGN,WAAW,CAAC,CAAC,CAC9B,GAAM,CAAAO,IAAI,CAAGN,WAAW,CAACG,UAAU,CAAC,CACpC,GAAM,CAAAI,WAAW,CAAGP,WAAW,CAACE,iBAAiB,CAAC,CAClD,GAAM,CAAAM,6BAA6B,CAAGX,0BAA0B,CAAC,CAAC,CAClE,GAAM,CAAAY,mCAAmC,CACvCX,gCAAgC,CAAC,CAAC,CAEpC,GAAM,CAAAY,YAAY,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,SAAA,MAAAC,uBAAA,CAAAC,6BAAA,CAAAC,gBAAA,QAAAL,mBAAA,GAAAM,IAAA,UAAAC,UAAAC,SAAA,iBAAAA,SAAA,CAAAC,IAAA,CAAAD,SAAA,CAAAE,IAAA,YACdhB,WAAW,SAAXA,WAAW,WAAXA,WAAW,CAAEiB,IAAI,EAAAH,SAAA,CAAAE,IAAA,iBAAAF,SAAA,CAAAI,MAAA,kBAAAJ,SAAA,CAAAE,IAAA,SACgB,CAAAf,6BAA6B,QAA7DQ,uBAAuB,CAAAK,SAAA,CAAAK,IAAA,CAAAL,SAAA,CAAAE,IAAA,SAErB,CAAAd,mCAAmC,QADrCQ,6BAA6B,CAAAI,SAAA,CAAAK,IAAA,CAG7BR,gBAAgB,CAAGF,uBAAuB,CAC7CW,mBAAmB,CAAC,EAACpB,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEiB,IAAI,EAAC,CACvCI,IAAI,CAAC,SAACC,EAAE,QAAK,CAAAA,EAAE,SAAFA,EAAE,iBAAFA,EAAE,CAAEC,IAAI,GAAC,IACpBZ,gBAAgB,EAAAG,SAAA,CAAAE,IAAA,kBAAAF,SAAA,CAAAI,MAAA,0BAAAJ,SAAA,CAAAI,MAAA,UAEdR,6BAA6B,CACjCc,OAAO,CAACC,OAAO,CAACC,GAAG,CAACC,uBAAuB,CAAEhB,gBAAgB,CAAC,CAC9DU,IAAI,6BAAAO,KAAA,CAAAvB,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAC,SAAAsB,QAAOP,EAAE,SAAAhB,mBAAA,GAAAM,IAAA,UAAAkB,SAAAC,QAAA,iBAAAA,QAAA,CAAAhB,IAAA,CAAAgB,QAAA,CAAAf,IAAA,SACb,GAAI,CAAA3B,UAAU,CAAC,CAAC,CAAC2C,MAAM,CAAC,CACtBC,SAAS,CAAElC,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEkC,SAAS,CAC1BC,IAAI,CAAE,SAAS,CACfC,MAAM,CAAE,cAAc,CACtBC,WAAW,CAAE,cAAc,CAC3Bd,EAAE,CAAEe,IAAI,CAACC,SAAS,CAAChB,EAAE,CACvB,CAAC,CAAC,CAACS,QAAA,CAAAf,IAAA,SAEG,CAAAM,EAAE,CAACiB,IAAI,CAAC,CAAC,QACf7C,OAAO,CAAC8C,qBAAqB,CAAC1C,QAAQ,CAAEwB,EAAE,SAAFA,EAAE,iBAAFA,EAAE,CAAEmB,IAAI,CAAC,CAAC,OAAAV,QAAA,CAAAb,MAAA,UAC3C,IAAI,0BAAAa,QAAA,CAAAW,IAAA,MAAAb,OAAA,GACZ,mBAAAc,EAAA,SAAAf,KAAA,CAAAgB,KAAA,MAAAC,SAAA,QAAC,CACDC,KAAK,CAAC,SAACC,GAAG,CAAK,CACd,GAAI,CAAA1D,UAAU,CAAC,CAAC,CAAC2C,MAAM,CAAC,CACtBC,SAAS,CAAElC,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEkC,SAAS,CAC1BC,IAAI,CAAE,OAAO,CACbC,MAAM,CAAE,cAAc,CACtBa,KAAK,CAAEX,IAAI,CAACC,SAAS,CAACS,GAAG,CAC3B,CAAC,CAAC,CAEF,KAAM,CAAAA,GAAG,CACX,CAAC,CAAC,2BAAAjC,SAAA,CAAA4B,IAAA,MAAAlC,QAAA,GACL,kBApCK,CAAAL,YAAYA,CAAA,SAAAC,IAAA,CAAAwC,KAAA,MAAAC,SAAA,OAoCjB,CACD,MAAO,CAAE1C,YAAY,CAAZA,YAAa,CAAC,CACzB"},"metadata":{},"sourceType":"module","externalDependencies":[]}