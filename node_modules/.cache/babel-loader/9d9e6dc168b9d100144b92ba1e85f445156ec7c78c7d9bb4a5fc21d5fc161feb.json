{"ast":null,"code":"import _regeneratorRuntime from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _toConsumableArray from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _asyncToGenerator from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport Queue from 'yocto-queue';\nexport default function pLimit(concurrency) {\n  if (!((Number.isInteger(concurrency) || concurrency === Number.POSITIVE_INFINITY) && concurrency > 0)) {\n    throw new TypeError('Expected `concurrency` to be a number from 1 and up');\n  }\n  var queue = new Queue();\n  var activeCount = 0;\n  var next = function next() {\n    activeCount--;\n    if (queue.size > 0) {\n      queue.dequeue()();\n    }\n  };\n  var run = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(fn, resolve, args) {\n      var result;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n            activeCount++;\n            result = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n              return _regeneratorRuntime().wrap(function _callee$(_context) {\n                while (1) switch (_context.prev = _context.next) {\n                  case 0:\n                    return _context.abrupt(\"return\", fn.apply(void 0, _toConsumableArray(args)));\n                  case 1:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }, _callee);\n            }))();\n            resolve(result);\n            _context2.prev = 3;\n            _context2.next = 6;\n            return result;\n          case 6:\n            _context2.next = 10;\n            break;\n          case 8:\n            _context2.prev = 8;\n            _context2.t0 = _context2[\"catch\"](3);\n          case 10:\n            next();\n          case 11:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2, null, [[3, 8]]);\n    }));\n    return function run(_x, _x2, _x3) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  var enqueue = function enqueue(fn, resolve, args) {\n    queue.enqueue(run.bind(undefined, fn, resolve, args));\n    _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return Promise.resolve();\n          case 2:\n            if (activeCount < concurrency && queue.size > 0) {\n              queue.dequeue()();\n            }\n          case 3:\n          case \"end\":\n            return _context3.stop();\n        }\n      }, _callee3);\n    }))();\n  };\n  var generator = function generator(fn) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n    return new Promise(function (resolve) {\n      enqueue(fn, resolve, args);\n    });\n  };\n  Object.defineProperties(generator, {\n    activeCount: {\n      get: function get() {\n        return activeCount;\n      }\n    },\n    pendingCount: {\n      get: function get() {\n        return queue.size;\n      }\n    },\n    clearQueue: {\n      value: function value() {\n        queue.clear();\n      }\n    }\n  });\n  return generator;\n}","map":{"version":3,"names":["Queue","pLimit","concurrency","Number","isInteger","POSITIVE_INFINITY","TypeError","queue","activeCount","next","size","dequeue","run","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","fn","resolve","args","result","wrap","_callee2$","_context2","prev","_callee","_callee$","_context","abrupt","apply","_toConsumableArray","stop","t0","_x","_x2","_x3","arguments","enqueue","bind","undefined","_callee3","_callee3$","_context3","Promise","generator","_len","length","Array","_key","Object","defineProperties","get","pendingCount","clearQueue","value","clear"],"sources":["/Users/apple/Documents/treasure/node_modules/p-settle/node_modules/p-limit/index.js"],"sourcesContent":["import Queue from 'yocto-queue';\n\nexport default function pLimit(concurrency) {\n\tif (!((Number.isInteger(concurrency) || concurrency === Number.POSITIVE_INFINITY) && concurrency > 0)) {\n\t\tthrow new TypeError('Expected `concurrency` to be a number from 1 and up');\n\t}\n\n\tconst queue = new Queue();\n\tlet activeCount = 0;\n\n\tconst next = () => {\n\t\tactiveCount--;\n\n\t\tif (queue.size > 0) {\n\t\t\tqueue.dequeue()();\n\t\t}\n\t};\n\n\tconst run = async (fn, resolve, args) => {\n\t\tactiveCount++;\n\n\t\tconst result = (async () => fn(...args))();\n\n\t\tresolve(result);\n\n\t\ttry {\n\t\t\tawait result;\n\t\t} catch {}\n\n\t\tnext();\n\t};\n\n\tconst enqueue = (fn, resolve, args) => {\n\t\tqueue.enqueue(run.bind(undefined, fn, resolve, args));\n\n\t\t(async () => {\n\t\t\t// This function needs to wait until the next microtask before comparing\n\t\t\t// `activeCount` to `concurrency`, because `activeCount` is updated asynchronously\n\t\t\t// when the run function is dequeued and called. The comparison in the if-statement\n\t\t\t// needs to happen asynchronously as well to get an up-to-date value for `activeCount`.\n\t\t\tawait Promise.resolve();\n\n\t\t\tif (activeCount < concurrency && queue.size > 0) {\n\t\t\t\tqueue.dequeue()();\n\t\t\t}\n\t\t})();\n\t};\n\n\tconst generator = (fn, ...args) => new Promise(resolve => {\n\t\tenqueue(fn, resolve, args);\n\t});\n\n\tObject.defineProperties(generator, {\n\t\tactiveCount: {\n\t\t\tget: () => activeCount,\n\t\t},\n\t\tpendingCount: {\n\t\t\tget: () => queue.size,\n\t\t},\n\t\tclearQueue: {\n\t\t\tvalue: () => {\n\t\t\t\tqueue.clear();\n\t\t\t},\n\t\t},\n\t});\n\n\treturn generator;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}