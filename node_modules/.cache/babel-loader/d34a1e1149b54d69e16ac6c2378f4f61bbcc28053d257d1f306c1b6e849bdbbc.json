{"ast":null,"code":"import _regeneratorRuntime from\"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import AirdropApi from\"api/AirdropApi\";import{ALERT_STATUS_FAILURE,ALERT_STATUS_SUCCESS,CLAIM_FOUNDERS_REWARDS_ALERT}from\"constant/alert\";import{useContractDailyBonusRewardsWithSigner}from\"hooks/blockchain/useHandleContracts\";import useHandleNFT from\"hooks/blockchain/useHandleNFT\";import{useDispatch,useSelector}from\"react-redux\";import ACTIONS from\"redux/action\";import{selectNftSelected}from\"redux/slice/nftSlice\";import{selectUser}from\"redux/slice/userSlice\";export default function useClaimBase(){var nftSelected=useSelector(selectNftSelected);var user=useSelector(selectUser);var dispatch=useDispatch();var handleNFT=useHandleNFT();var handleContractDailyBonusRewardsWithSigner=useContractDailyBonusRewardsWithSigner();var claimBase=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var contractDailyBonusRewardsWithSigner;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(user!==null&&user!==void 0&&user.wallet_id){_context2.next=2;break;}return _context2.abrupt(\"return\");case 2:if(nftSelected!==null&&nftSelected!==void 0&&nftSelected.tokenId){_context2.next=4;break;}return _context2.abrupt(\"return\");case 4:_context2.next=6;return handleContractDailyBonusRewardsWithSigner;case 6:contractDailyBonusRewardsWithSigner=_context2.sent;return _context2.abrupt(\"return\",contractDailyBonusRewardsWithSigner.claimBase(nftSelected===null||nftSelected===void 0?void 0:nftSelected.tokenId).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(tx){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:new AirdropApi().logger({wallet_id:user===null||user===void 0?void 0:user.wallet_id,type:\"PENDING\",action:\"claimBase\",description:\"Claimed base\",tx:JSON.stringify(tx)});_context.next=3;return tx.wait();case 3:ACTIONS.SET_TRANSANCTION_HASH(dispatch,tx===null||tx===void 0?void 0:tx.hash);// await sleep(15);\nhandleNFT.getRewardsReleased();handleNFT.balanceOfTRESR(user===null||user===void 0?void 0:user.wallet_id);handleNFT.getAVAXBalance(user===null||user===void 0?void 0:user.wallet_id);handleNFT.getPoolAllocation();ACTIONS.SET_ALERT(dispatch,true,ALERT_STATUS_SUCCESS,CLAIM_FOUNDERS_REWARDS_ALERT(true));case 9:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}()).catch(function(err){new AirdropApi().logger({wallet_id:user===null||user===void 0?void 0:user.wallet_id,type:\"ERROR\",action:\"claimBase\",description:\"Claimed base\",error:JSON.stringify(err)});ACTIONS.SET_ALERT(dispatch,true,ALERT_STATUS_FAILURE,CLAIM_FOUNDERS_REWARDS_ALERT(false));return null;}));case 8:case\"end\":return _context2.stop();}},_callee2);}));return function claimBase(){return _ref.apply(this,arguments);};}();return{claimBase:claimBase};}","map":{"version":3,"names":["AirdropApi","ALERT_STATUS_FAILURE","ALERT_STATUS_SUCCESS","CLAIM_FOUNDERS_REWARDS_ALERT","useContractDailyBonusRewardsWithSigner","useHandleNFT","useDispatch","useSelector","ACTIONS","selectNftSelected","selectUser","useClaimBase","nftSelected","user","dispatch","handleNFT","handleContractDailyBonusRewardsWithSigner","claimBase","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","contractDailyBonusRewardsWithSigner","wrap","_callee2$","_context2","prev","next","wallet_id","abrupt","tokenId","sent","then","_ref2","_callee","tx","_callee$","_context","logger","type","action","description","JSON","stringify","wait","SET_TRANSANCTION_HASH","hash","getRewardsReleased","balanceOfTRESR","getAVAXBalance","getPoolAllocation","SET_ALERT","stop","_x","apply","arguments","catch","err","error"],"sources":["/Users/apple/Documents/treasure/src/hooks/rewards/useClaimBase.js"],"sourcesContent":["import AirdropApi from \"api/AirdropApi\";\nimport {\n  ALERT_STATUS_FAILURE,\n  ALERT_STATUS_SUCCESS,\n  CLAIM_FOUNDERS_REWARDS_ALERT,\n} from \"constant/alert\";\nimport { useContractDailyBonusRewardsWithSigner } from \"hooks/blockchain/useHandleContracts\";\nimport useHandleNFT from \"hooks/blockchain/useHandleNFT\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport ACTIONS from \"redux/action\";\nimport { selectNftSelected } from \"redux/slice/nftSlice\";\nimport { selectUser } from \"redux/slice/userSlice\";\n\nexport default function useClaimBase() {\n  const nftSelected = useSelector(selectNftSelected);\n  const user = useSelector(selectUser);\n  const dispatch = useDispatch();\n  const handleNFT = useHandleNFT();\n  const handleContractDailyBonusRewardsWithSigner =\n    useContractDailyBonusRewardsWithSigner();\n\n  const claimBase = async () => {\n    if (!user?.wallet_id) return;\n    if (!nftSelected?.tokenId) return;\n\n    const contractDailyBonusRewardsWithSigner =\n      await handleContractDailyBonusRewardsWithSigner;\n    return contractDailyBonusRewardsWithSigner\n      .claimBase(nftSelected?.tokenId)\n      .then(async (tx) => {\n        new AirdropApi().logger({\n          wallet_id: user?.wallet_id,\n          type: \"PENDING\",\n          action: \"claimBase\",\n          description: `Claimed base`,\n          tx: JSON.stringify(tx),\n        });\n        await tx.wait();\n        ACTIONS.SET_TRANSANCTION_HASH(dispatch, tx?.hash);\n        // await sleep(15);\n\n        handleNFT.getRewardsReleased();\n        handleNFT.balanceOfTRESR(user?.wallet_id);\n        handleNFT.getAVAXBalance(user?.wallet_id);\n        handleNFT.getPoolAllocation();\n\n        ACTIONS.SET_ALERT(\n          dispatch,\n          true,\n          ALERT_STATUS_SUCCESS,\n          CLAIM_FOUNDERS_REWARDS_ALERT(true)\n        );\n      })\n      .catch((err) => {\n        new AirdropApi().logger({\n          wallet_id: user?.wallet_id,\n          type: \"ERROR\",\n          action: \"claimBase\",\n          description: `Claimed base`,\n          error: JSON.stringify(err),\n        });\n\n        ACTIONS.SET_ALERT(\n          dispatch,\n          true,\n          ALERT_STATUS_FAILURE,\n          CLAIM_FOUNDERS_REWARDS_ALERT(false)\n        );\n\n        return null;\n      });\n  };\n  return { claimBase };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}