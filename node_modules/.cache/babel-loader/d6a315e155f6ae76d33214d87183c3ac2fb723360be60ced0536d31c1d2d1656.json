{"ast":null,"code":"import _slicedToArray from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _regeneratorRuntime from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _classCallCheck from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _inherits from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _wrapAsyncGenerator from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/wrapAsyncGenerator.js\";\nimport _awaitAsyncGenerator from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/awaitAsyncGenerator.js\";\nimport _asyncGeneratorDelegate from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/asyncGeneratorDelegate.js\";\nimport _asyncIterator from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/asyncIterator.js\";\nimport { BaseDatastore } from './base.js';\nimport { Key } from 'interface-datastore/key';\nimport * as Errors from './errors.js';\n\n/**\n * @typedef {import('interface-datastore').Pair} Pair\n * @typedef {import('interface-datastore').Datastore} Datastore\n * @typedef {import('interface-store').Options} Options\n */\n\n/**\n * @class MemoryDatastore\n * @implements {Datastore}\n */\nexport var MemoryDatastore = /*#__PURE__*/function (_BaseDatastore) {\n  _inherits(MemoryDatastore, _BaseDatastore);\n  var _super = _createSuper(MemoryDatastore);\n  function MemoryDatastore() {\n    var _this3;\n    _classCallCheck(this, MemoryDatastore);\n    _this3 = _super.call(this);\n\n    /** @type {Record<string, Uint8Array>} */\n    _this3.data = {};\n    return _this3;\n  }\n  _createClass(MemoryDatastore, [{\n    key: \"open\",\n    value: function open() {\n      return Promise.resolve();\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      return Promise.resolve();\n    }\n\n    /**\n     * @param {Key} key\n     * @param {Uint8Array} val\n     */\n  }, {\n    key: \"put\",\n    value: function () {\n      var _put = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(key, val) {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              // eslint-disable-line require-await\n              this.data[key.toString()] = val;\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function put(_x, _x2) {\n        return _put.apply(this, arguments);\n      }\n      return put;\n    }()\n    /**\n     * @param {Key} key\n     */\n  }, {\n    key: \"get\",\n    value: function () {\n      var _get = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(key) {\n        var exists;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return this.has(key);\n            case 2:\n              exists = _context2.sent;\n              if (exists) {\n                _context2.next = 5;\n                break;\n              }\n              throw Errors.notFoundError();\n            case 5:\n              return _context2.abrupt(\"return\", this.data[key.toString()]);\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function get(_x3) {\n        return _get.apply(this, arguments);\n      }\n      return get;\n    }()\n    /**\n     * @param {Key} key\n     */\n  }, {\n    key: \"has\",\n    value: function () {\n      var _has = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(key) {\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              return _context3.abrupt(\"return\", this.data[key.toString()] !== undefined);\n            case 1:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function has(_x4) {\n        return _has.apply(this, arguments);\n      }\n      return has;\n    }()\n    /**\n     * @param {Key} key\n     */\n  }, {\n    key: \"delete\",\n    value: function () {\n      var _delete2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(key) {\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              // eslint-disable-line require-await\n              delete this.data[key.toString()];\n            case 1:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this);\n      }));\n      function _delete(_x5) {\n        return _delete2.apply(this, arguments);\n      }\n      return _delete;\n    }()\n  }, {\n    key: \"_all\",\n    value: function _all() {\n      var _this = this;\n      return _wrapAsyncGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              return _context5.delegateYield(_asyncGeneratorDelegate(_asyncIterator(Object.entries(_this.data).map(function (_ref) {\n                var _ref2 = _slicedToArray(_ref, 2),\n                  key = _ref2[0],\n                  value = _ref2[1];\n                return {\n                  key: new Key(key),\n                  value: value\n                };\n              })), _awaitAsyncGenerator), \"t0\", 1);\n            case 1:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5);\n      }))();\n    }\n  }, {\n    key: \"_allKeys\",\n    value: function _allKeys() {\n      var _this2 = this;\n      return _wrapAsyncGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              return _context6.delegateYield(_asyncGeneratorDelegate(_asyncIterator(Object.entries(_this2.data).map(function (_ref3) {\n                var _ref4 = _slicedToArray(_ref3, 1),\n                  key = _ref4[0];\n                return new Key(key);\n              })), _awaitAsyncGenerator), \"t0\", 1);\n            case 1:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6);\n      }))();\n    }\n  }]);\n  return MemoryDatastore;\n}(BaseDatastore);","map":{"version":3,"names":["BaseDatastore","Key","Errors","MemoryDatastore","_BaseDatastore","_inherits","_super","_createSuper","_this3","_classCallCheck","call","data","_createClass","key","value","open","Promise","resolve","close","_put","_asyncToGenerator","_regeneratorRuntime","mark","_callee","val","wrap","_callee$","_context","prev","next","toString","stop","put","_x","_x2","apply","arguments","_get","_callee2","exists","_callee2$","_context2","has","sent","notFoundError","abrupt","get","_x3","_has","_callee3","_callee3$","_context3","undefined","_x4","_delete2","_callee4","_callee4$","_context4","_delete","_x5","_all","_this","_wrapAsyncGenerator","_callee5","_callee5$","_context5","delegateYield","_asyncGeneratorDelegate","_asyncIterator","Object","entries","map","_ref","_ref2","_slicedToArray","_awaitAsyncGenerator","_allKeys","_this2","_callee6","_callee6$","_context6","_ref3","_ref4"],"sources":["/Users/apple/Documents/treasure/node_modules/datastore-core/src/memory.js"],"sourcesContent":["import { BaseDatastore } from './base.js'\nimport { Key } from 'interface-datastore/key'\nimport * as Errors from './errors.js'\n\n/**\n * @typedef {import('interface-datastore').Pair} Pair\n * @typedef {import('interface-datastore').Datastore} Datastore\n * @typedef {import('interface-store').Options} Options\n */\n\n/**\n * @class MemoryDatastore\n * @implements {Datastore}\n */\nexport class MemoryDatastore extends BaseDatastore {\n  constructor () {\n    super()\n\n    /** @type {Record<string, Uint8Array>} */\n    this.data = {}\n  }\n\n  open () {\n    return Promise.resolve()\n  }\n\n  close () {\n    return Promise.resolve()\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Uint8Array} val\n   */\n  async put (key, val) { // eslint-disable-line require-await\n    this.data[key.toString()] = val\n  }\n\n  /**\n   * @param {Key} key\n   */\n  async get (key) {\n    const exists = await this.has(key)\n    if (!exists) throw Errors.notFoundError()\n    return this.data[key.toString()]\n  }\n\n  /**\n   * @param {Key} key\n   */\n  async has (key) { // eslint-disable-line require-await\n    return this.data[key.toString()] !== undefined\n  }\n\n  /**\n   * @param {Key} key\n   */\n  async delete (key) { // eslint-disable-line require-await\n    delete this.data[key.toString()]\n  }\n\n  async * _all () {\n    yield * Object.entries(this.data)\n      .map(([key, value]) => ({ key: new Key(key), value }))\n  }\n\n  async * _allKeys () {\n    yield * Object.entries(this.data)\n      .map(([key]) => new Key(key))\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}