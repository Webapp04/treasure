{"ast":null,"code":"var _classCallCheck = require(\"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\nvar _createClass = require(\"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/createClass.js\").default;\nvar Fifo = require('fast-fifo');\nvar defer = require('p-defer');\nmodule.exports = /*#__PURE__*/function () {\n  \"use strict\";\n\n  function PFifo() {\n    _classCallCheck(this, PFifo);\n    this._buffer = new Fifo();\n    this._waitingConsumers = new Fifo();\n  }\n  _createClass(PFifo, [{\n    key: \"push\",\n    value: function push(chunk) {\n      var _defer = defer(),\n        promise = _defer.promise,\n        resolve = _defer.resolve;\n      this._buffer.push({\n        chunk: chunk,\n        resolve: resolve\n      });\n      this._consume();\n      return promise;\n    }\n  }, {\n    key: \"_consume\",\n    value: function _consume() {\n      while (!this._waitingConsumers.isEmpty() && !this._buffer.isEmpty()) {\n        var nextConsumer = this._waitingConsumers.shift();\n        var nextChunk = this._buffer.shift();\n        nextConsumer.resolve(nextChunk.chunk);\n        nextChunk.resolve();\n      }\n    }\n  }, {\n    key: \"shift\",\n    value: function shift() {\n      var _defer2 = defer(),\n        promise = _defer2.promise,\n        resolve = _defer2.resolve;\n      this._waitingConsumers.push({\n        resolve: resolve\n      });\n      this._consume();\n      return promise;\n    }\n  }, {\n    key: \"isEmpty\",\n    value: function isEmpty() {\n      return this._buffer.isEmpty();\n    }\n  }]);\n  return PFifo;\n}();","map":{"version":3,"names":["Fifo","require","defer","module","exports","PFifo","_classCallCheck","_buffer","_waitingConsumers","_createClass","key","value","push","chunk","_defer","promise","resolve","_consume","isEmpty","nextConsumer","shift","nextChunk","_defer2"],"sources":["/Users/apple/Documents/treasure/node_modules/p-fifo/index.js"],"sourcesContent":["const Fifo = require('fast-fifo')\nconst defer = require('p-defer')\n\nmodule.exports = class PFifo {\n  constructor () {\n    this._buffer = new Fifo()\n    this._waitingConsumers = new Fifo()\n  }\n\n  push (chunk) {\n    const { promise, resolve } = defer()\n    this._buffer.push({ chunk, resolve })\n    this._consume()\n    return promise\n  }\n\n  _consume () {\n    while (!this._waitingConsumers.isEmpty() && !this._buffer.isEmpty()) {\n      const nextConsumer = this._waitingConsumers.shift()\n      const nextChunk = this._buffer.shift()\n      nextConsumer.resolve(nextChunk.chunk)\n      nextChunk.resolve()\n    }\n  }\n\n  shift () {\n    const { promise, resolve } = defer()\n    this._waitingConsumers.push({ resolve })\n    this._consume()\n    return promise\n  }\n\n  isEmpty () {\n    return this._buffer.isEmpty()\n  }\n}\n"],"mappings":";;AAAA,IAAMA,IAAI,GAAGC,OAAO,CAAC,WAAW,CAAC;AACjC,IAAMC,KAAK,GAAGD,OAAO,CAAC,SAAS,CAAC;AAEhCE,MAAM,CAACC,OAAO;EAAA;;EACZ,SAAAC,MAAA,EAAe;IAAAC,eAAA,OAAAD,KAAA;IACb,IAAI,CAACE,OAAO,GAAG,IAAIP,IAAI,CAAC,CAAC;IACzB,IAAI,CAACQ,iBAAiB,GAAG,IAAIR,IAAI,CAAC,CAAC;EACrC;EAACS,YAAA,CAAAJ,KAAA;IAAAK,GAAA;IAAAC,KAAA,EAED,SAAAC,KAAMC,KAAK,EAAE;MACX,IAAAC,MAAA,GAA6BZ,KAAK,CAAC,CAAC;QAA5Ba,OAAO,GAAAD,MAAA,CAAPC,OAAO;QAAEC,OAAO,GAAAF,MAAA,CAAPE,OAAO;MACxB,IAAI,CAACT,OAAO,CAACK,IAAI,CAAC;QAAEC,KAAK,EAALA,KAAK;QAAEG,OAAO,EAAPA;MAAQ,CAAC,CAAC;MACrC,IAAI,CAACC,QAAQ,CAAC,CAAC;MACf,OAAOF,OAAO;IAChB;EAAC;IAAAL,GAAA;IAAAC,KAAA,EAED,SAAAM,SAAA,EAAY;MACV,OAAO,CAAC,IAAI,CAACT,iBAAiB,CAACU,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAACX,OAAO,CAACW,OAAO,CAAC,CAAC,EAAE;QACnE,IAAMC,YAAY,GAAG,IAAI,CAACX,iBAAiB,CAACY,KAAK,CAAC,CAAC;QACnD,IAAMC,SAAS,GAAG,IAAI,CAACd,OAAO,CAACa,KAAK,CAAC,CAAC;QACtCD,YAAY,CAACH,OAAO,CAACK,SAAS,CAACR,KAAK,CAAC;QACrCQ,SAAS,CAACL,OAAO,CAAC,CAAC;MACrB;IACF;EAAC;IAAAN,GAAA;IAAAC,KAAA,EAED,SAAAS,MAAA,EAAS;MACP,IAAAE,OAAA,GAA6BpB,KAAK,CAAC,CAAC;QAA5Ba,OAAO,GAAAO,OAAA,CAAPP,OAAO;QAAEC,OAAO,GAAAM,OAAA,CAAPN,OAAO;MACxB,IAAI,CAACR,iBAAiB,CAACI,IAAI,CAAC;QAAEI,OAAO,EAAPA;MAAQ,CAAC,CAAC;MACxC,IAAI,CAACC,QAAQ,CAAC,CAAC;MACf,OAAOF,OAAO;IAChB;EAAC;IAAAL,GAAA;IAAAC,KAAA,EAED,SAAAO,QAAA,EAAW;MACT,OAAO,IAAI,CAACX,OAAO,CAACW,OAAO,CAAC,CAAC;IAC/B;EAAC;EAAA,OAAAb,KAAA;AAAA,GACF"},"metadata":{},"sourceType":"script","externalDependencies":[]}