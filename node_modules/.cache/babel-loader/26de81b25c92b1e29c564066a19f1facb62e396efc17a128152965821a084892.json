{"ast":null,"code":"import _createForOfIteratorHelper from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\n// @ts-expect-error no types\nimport ReaderClass from 'protobufjs/src/reader.js';\n// @ts-expect-error no types\nimport ReaderBufferClass from 'protobufjs/src/reader_buffer.js';\n// @ts-expect-error no types\nimport WriterClass from 'protobufjs/src/writer.js';\n// @ts-expect-error no types\nimport WriterBufferClass from 'protobufjs/src/writer_buffer.js';\n// @ts-expect-error no types\nimport util from 'protobufjs/src/util/minimal.js';\nfunction configure() {\n  util._configure();\n  ReaderClass._configure(ReaderBufferClass);\n  WriterClass._configure(WriterBufferClass);\n}\n// Set up buffer utility according to the environment\nconfigure();\n// monkey patch the reader to add native bigint support\nvar methods = ['uint64', 'int64', 'sint64', 'fixed64', 'sfixed64'];\nfunction patchReader(obj) {\n  var _iterator = _createForOfIteratorHelper(methods),\n    _step;\n  try {\n    var _loop = function _loop() {\n      var method = _step.value;\n      if (obj[method] == null) {\n        return 1; // continue\n      }\n      var original = obj[method];\n      obj[method] = function () {\n        return BigInt(original.call(this).toString());\n      };\n    };\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      if (_loop()) continue;\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n  return obj;\n}\nexport function reader(buf) {\n  return patchReader(new ReaderClass(buf));\n}\nfunction patchWriter(obj) {\n  var _iterator2 = _createForOfIteratorHelper(methods),\n    _step2;\n  try {\n    var _loop2 = function _loop2() {\n      var method = _step2.value;\n      if (obj[method] == null) {\n        return 1; // continue\n      }\n      var original = obj[method];\n      obj[method] = function (val) {\n        return original.call(this, val.toString());\n      };\n    };\n    for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n      if (_loop2()) continue;\n    }\n  } catch (err) {\n    _iterator2.e(err);\n  } finally {\n    _iterator2.f();\n  }\n  return obj;\n}\nexport function writer() {\n  return patchWriter(WriterClass.create());\n}","map":{"version":3,"names":["ReaderClass","ReaderBufferClass","WriterClass","WriterBufferClass","util","configure","_configure","methods","patchReader","obj","_iterator","_createForOfIteratorHelper","_step","_loop","method","value","original","BigInt","call","toString","s","n","done","err","e","f","reader","buf","patchWriter","_iterator2","_step2","_loop2","val","writer","create"],"sources":["/Users/apple/Documents/treasure/node_modules/@libp2p/crypto/node_modules/protons-runtime/src/utils.ts"],"sourcesContent":["// @ts-expect-error no types\nimport ReaderClass from 'protobufjs/src/reader.js'\n// @ts-expect-error no types\nimport ReaderBufferClass from 'protobufjs/src/reader_buffer.js'\n// @ts-expect-error no types\nimport WriterClass from 'protobufjs/src/writer.js'\n// @ts-expect-error no types\nimport WriterBufferClass from 'protobufjs/src/writer_buffer.js'\n// @ts-expect-error no types\nimport util from 'protobufjs/src/util/minimal.js'\nimport type { Reader, Writer } from './index.js'\n\nfunction configure (): void {\n  util._configure()\n  ReaderClass._configure(ReaderBufferClass)\n  WriterClass._configure(WriterBufferClass)\n}\n\n// Set up buffer utility according to the environment\nconfigure()\n\n// monkey patch the reader to add native bigint support\nconst methods = [\n  'uint64', 'int64', 'sint64', 'fixed64', 'sfixed64'\n]\n\nfunction patchReader (obj: any): any {\n  for (const method of methods) {\n    if (obj[method] == null) {\n      continue\n    }\n\n    const original = obj[method]\n    obj[method] = function (): bigint {\n      return BigInt(original.call(this).toString())\n    }\n  }\n\n  return obj\n}\n\nexport function reader (buf: Uint8Array): Reader {\n  return patchReader(new ReaderClass(buf))\n}\n\nfunction patchWriter (obj: any): any {\n  for (const method of methods) {\n    if (obj[method] == null) {\n      continue\n    }\n\n    const original = obj[method]\n    obj[method] = function (val: bigint) {\n      return original.call(this, val.toString())\n    }\n  }\n\n  return obj\n}\n\nexport function writer (): Writer {\n  return patchWriter(WriterClass.create())\n}\n"],"mappings":";AAAA;AACA,OAAOA,WAAW,MAAM,0BAA0B;AAClD;AACA,OAAOC,iBAAiB,MAAM,iCAAiC;AAC/D;AACA,OAAOC,WAAW,MAAM,0BAA0B;AAClD;AACA,OAAOC,iBAAiB,MAAM,iCAAiC;AAC/D;AACA,OAAOC,IAAI,MAAM,gCAAgC;AAGjD,SAASC,SAASA,CAAA;EAChBD,IAAI,CAACE,UAAU,EAAE;EACjBN,WAAW,CAACM,UAAU,CAACL,iBAAiB,CAAC;EACzCC,WAAW,CAACI,UAAU,CAACH,iBAAiB,CAAC;AAC3C;AAEA;AACAE,SAAS,EAAE;AAEX;AACA,IAAME,OAAO,GAAG,CACd,QAAQ,EAAE,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,UAAU,CACnD;AAED,SAASC,WAAWA,CAAEC,GAAQ;EAAA,IAAAC,SAAA,GAAAC,0BAAA,CACPJ,OAAO;IAAAK,KAAA;EAAA;IAAA,IAAAC,KAAA,YAAAA,MAAA,EAAE;MAAA,IAAnBC,MAAM,GAAAF,KAAA,CAAAG,KAAA;MACf,IAAIN,GAAG,CAACK,MAAM,CAAC,IAAI,IAAI,EAAE;QAAA;;MAIzB,IAAME,QAAQ,GAAGP,GAAG,CAACK,MAAM,CAAC;MAC5BL,GAAG,CAACK,MAAM,CAAC,GAAG;QACZ,OAAOG,MAAM,CAACD,QAAQ,CAACE,IAAI,CAAC,IAAI,CAAC,CAACC,QAAQ,EAAE,CAAC;MAC/C,CAAC;KACF;IATD,KAAAT,SAAA,CAAAU,CAAA,MAAAR,KAAA,GAAAF,SAAA,CAAAW,CAAA,IAAAC,IAAA;MAAA,IAAAT,KAAA,IAEI;IAAQ;EAOX,SAAAU,GAAA;IAAAb,SAAA,CAAAc,CAAA,CAAAD,GAAA;EAAA;IAAAb,SAAA,CAAAe,CAAA;EAAA;EAED,OAAOhB,GAAG;AACZ;AAEA,OAAM,SAAUiB,MAAMA,CAAEC,GAAe;EACrC,OAAOnB,WAAW,CAAC,IAAIR,WAAW,CAAC2B,GAAG,CAAC,CAAC;AAC1C;AAEA,SAASC,WAAWA,CAAEnB,GAAQ;EAAA,IAAAoB,UAAA,GAAAlB,0BAAA,CACPJ,OAAO;IAAAuB,MAAA;EAAA;IAAA,IAAAC,MAAA,YAAAA,OAAA,EAAE;MAAA,IAAnBjB,MAAM,GAAAgB,MAAA,CAAAf,KAAA;MACf,IAAIN,GAAG,CAACK,MAAM,CAAC,IAAI,IAAI,EAAE;QAAA;;MAIzB,IAAME,QAAQ,GAAGP,GAAG,CAACK,MAAM,CAAC;MAC5BL,GAAG,CAACK,MAAM,CAAC,GAAG,UAAUkB,GAAW;QACjC,OAAOhB,QAAQ,CAACE,IAAI,CAAC,IAAI,EAAEc,GAAG,CAACb,QAAQ,EAAE,CAAC;MAC5C,CAAC;KACF;IATD,KAAAU,UAAA,CAAAT,CAAA,MAAAU,MAAA,GAAAD,UAAA,CAAAR,CAAA,IAAAC,IAAA;MAAA,IAAAS,MAAA,IAEI;IAAQ;EAOX,SAAAR,GAAA;IAAAM,UAAA,CAAAL,CAAA,CAAAD,GAAA;EAAA;IAAAM,UAAA,CAAAJ,CAAA;EAAA;EAED,OAAOhB,GAAG;AACZ;AAEA,OAAM,SAAUwB,MAAMA,CAAA;EACpB,OAAOL,WAAW,CAAC1B,WAAW,CAACgC,MAAM,EAAE,CAAC;AAC1C"},"metadata":{},"sourceType":"module","externalDependencies":[]}