{"ast":null,"code":"var _classCallCheck = require(\"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\nvar _createClass = require(\"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/createClass.js\").default;\nmodule.exports = /*#__PURE__*/function () {\n  \"use strict\";\n\n  /**\n   *\n   * @param opts Object Defaults {\n   *   points: 4, // Number of points\n   *   duration: 1, // Per seconds\n   *   blockDuration: 0, // Block if consumed more than points in current duration for blockDuration seconds\n   *   execEvenly: false, // Execute allowed actions evenly over duration\n   *   execEvenlyMinDelayMs: duration * 1000 / points, // ms, works with execEvenly=true option\n   *   keyPrefix: 'rlflx',\n   * }\n   */\n  function RateLimiterAbstract() {\n    var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    _classCallCheck(this, RateLimiterAbstract);\n    this.points = opts.points;\n    this.duration = opts.duration;\n    this.blockDuration = opts.blockDuration;\n    this.execEvenly = opts.execEvenly;\n    this.execEvenlyMinDelayMs = opts.execEvenlyMinDelayMs;\n    this.keyPrefix = opts.keyPrefix;\n  }\n  _createClass(RateLimiterAbstract, [{\n    key: \"points\",\n    get: function get() {\n      return this._points;\n    },\n    set: function set(value) {\n      this._points = value >= 0 ? value : 4;\n    }\n  }, {\n    key: \"duration\",\n    get: function get() {\n      return this._duration;\n    },\n    set: function set(value) {\n      this._duration = typeof value === 'undefined' ? 1 : value;\n    }\n  }, {\n    key: \"msDuration\",\n    get: function get() {\n      return this.duration * 1000;\n    }\n  }, {\n    key: \"blockDuration\",\n    get: function get() {\n      return this._blockDuration;\n    },\n    set: function set(value) {\n      this._blockDuration = typeof value === 'undefined' ? 0 : value;\n    }\n  }, {\n    key: \"msBlockDuration\",\n    get: function get() {\n      return this.blockDuration * 1000;\n    }\n  }, {\n    key: \"execEvenly\",\n    get: function get() {\n      return this._execEvenly;\n    },\n    set: function set(value) {\n      this._execEvenly = typeof value === 'undefined' ? false : Boolean(value);\n    }\n  }, {\n    key: \"execEvenlyMinDelayMs\",\n    get: function get() {\n      return this._execEvenlyMinDelayMs;\n    },\n    set: function set(value) {\n      this._execEvenlyMinDelayMs = typeof value === 'undefined' ? Math.ceil(this.msDuration / this.points) : value;\n    }\n  }, {\n    key: \"keyPrefix\",\n    get: function get() {\n      return this._keyPrefix;\n    },\n    set: function set(value) {\n      if (typeof value === 'undefined') {\n        value = 'rlflx';\n      }\n      if (typeof value !== 'string') {\n        throw new Error('keyPrefix must be string');\n      }\n      this._keyPrefix = value;\n    }\n  }, {\n    key: \"_getKeySecDuration\",\n    value: function _getKeySecDuration() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return options && options.customDuration >= 0 ? options.customDuration : this.duration;\n    }\n  }, {\n    key: \"getKey\",\n    value: function getKey(key) {\n      return this.keyPrefix.length > 0 ? \"\".concat(this.keyPrefix, \":\").concat(key) : key;\n    }\n  }, {\n    key: \"parseKey\",\n    value: function parseKey(rlKey) {\n      return rlKey.substring(this.keyPrefix.length);\n    }\n  }, {\n    key: \"consume\",\n    value: function consume() {\n      throw new Error(\"You have to implement the method 'consume'!\");\n    }\n  }, {\n    key: \"penalty\",\n    value: function penalty() {\n      throw new Error(\"You have to implement the method 'penalty'!\");\n    }\n  }, {\n    key: \"reward\",\n    value: function reward() {\n      throw new Error(\"You have to implement the method 'reward'!\");\n    }\n  }, {\n    key: \"get\",\n    value: function get() {\n      throw new Error(\"You have to implement the method 'get'!\");\n    }\n  }, {\n    key: \"set\",\n    value: function set() {\n      throw new Error(\"You have to implement the method 'set'!\");\n    }\n  }, {\n    key: \"block\",\n    value: function block() {\n      throw new Error(\"You have to implement the method 'block'!\");\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete() {\n      throw new Error(\"You have to implement the method 'delete'!\");\n    }\n  }]);\n  return RateLimiterAbstract;\n}();","map":{"version":3,"names":["module","exports","RateLimiterAbstract","opts","arguments","length","undefined","_classCallCheck","points","duration","blockDuration","execEvenly","execEvenlyMinDelayMs","keyPrefix","_createClass","key","get","_points","set","value","_duration","_blockDuration","_execEvenly","Boolean","_execEvenlyMinDelayMs","Math","ceil","msDuration","_keyPrefix","Error","_getKeySecDuration","options","customDuration","getKey","concat","parseKey","rlKey","substring","consume","penalty","reward","block","_delete"],"sources":["/Users/apple/Documents/treasure/node_modules/rate-limiter-flexible/lib/RateLimiterAbstract.js"],"sourcesContent":["module.exports = class RateLimiterAbstract {\n  /**\n   *\n   * @param opts Object Defaults {\n   *   points: 4, // Number of points\n   *   duration: 1, // Per seconds\n   *   blockDuration: 0, // Block if consumed more than points in current duration for blockDuration seconds\n   *   execEvenly: false, // Execute allowed actions evenly over duration\n   *   execEvenlyMinDelayMs: duration * 1000 / points, // ms, works with execEvenly=true option\n   *   keyPrefix: 'rlflx',\n   * }\n   */\n  constructor(opts = {}) {\n    this.points = opts.points;\n    this.duration = opts.duration;\n    this.blockDuration = opts.blockDuration;\n    this.execEvenly = opts.execEvenly;\n    this.execEvenlyMinDelayMs = opts.execEvenlyMinDelayMs;\n    this.keyPrefix = opts.keyPrefix;\n  }\n\n  get points() {\n    return this._points;\n  }\n\n  set points(value) {\n    this._points = value >= 0 ? value : 4;\n  }\n\n  get duration() {\n    return this._duration;\n  }\n\n  set duration(value) {\n    this._duration = typeof value === 'undefined' ? 1 : value;\n  }\n\n  get msDuration() {\n    return this.duration * 1000;\n  }\n\n  get blockDuration() {\n    return this._blockDuration;\n  }\n\n  set blockDuration(value) {\n    this._blockDuration = typeof value === 'undefined' ? 0 : value;\n  }\n\n  get msBlockDuration() {\n    return this.blockDuration * 1000;\n  }\n\n  get execEvenly() {\n    return this._execEvenly;\n  }\n\n  set execEvenly(value) {\n    this._execEvenly = typeof value === 'undefined' ? false : Boolean(value);\n  }\n\n  get execEvenlyMinDelayMs() {\n    return this._execEvenlyMinDelayMs;\n  }\n\n  set execEvenlyMinDelayMs(value) {\n    this._execEvenlyMinDelayMs = typeof value === 'undefined' ? Math.ceil(this.msDuration / this.points) : value;\n  }\n\n  get keyPrefix() {\n    return this._keyPrefix;\n  }\n\n  set keyPrefix(value) {\n    if (typeof value === 'undefined') {\n      value = 'rlflx';\n    }\n    if (typeof value !== 'string') {\n      throw new Error('keyPrefix must be string');\n    }\n    this._keyPrefix = value;\n  }\n\n  _getKeySecDuration(options = {}) {\n    return options && options.customDuration >= 0\n      ? options.customDuration\n      : this.duration;\n  }\n\n  getKey(key) {\n    return this.keyPrefix.length > 0 ? `${this.keyPrefix}:${key}` : key;\n  }\n\n  parseKey(rlKey) {\n    return rlKey.substring(this.keyPrefix.length);\n  }\n\n  consume() {\n    throw new Error(\"You have to implement the method 'consume'!\");\n  }\n\n  penalty() {\n    throw new Error(\"You have to implement the method 'penalty'!\");\n  }\n\n  reward() {\n    throw new Error(\"You have to implement the method 'reward'!\");\n  }\n\n  get() {\n    throw new Error(\"You have to implement the method 'get'!\");\n  }\n\n  set() {\n    throw new Error(\"You have to implement the method 'set'!\");\n  }\n\n  block() {\n    throw new Error(\"You have to implement the method 'block'!\");\n  }\n\n  delete() {\n    throw new Error(\"You have to implement the method 'delete'!\");\n  }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}