{"ast":null,"code":"import _regeneratorRuntime from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _wrapAsyncGenerator from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/wrapAsyncGenerator.js\";\nimport _awaitAsyncGenerator from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/awaitAsyncGenerator.js\";\nimport _asyncGeneratorDelegate from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/asyncGeneratorDelegate.js\";\nimport _asyncIterator from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/asyncIterator.js\";\nimport defer from 'p-defer';\n/**\n * A pair of streams where one drains from the other\n */\nexport function pair() {\n  var deferred = defer();\n  var piped = false;\n  return {\n    sink: function () {\n      var _sink = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(source) {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              if (!piped) {\n                _context.next = 2;\n                break;\n              }\n              throw new Error('already piped');\n            case 2:\n              piped = true;\n              deferred.resolve(source);\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }));\n      function sink(_x) {\n        return _sink.apply(this, arguments);\n      }\n      return sink;\n    }(),\n    source: _wrapAsyncGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      var source;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _awaitAsyncGenerator(deferred.promise);\n          case 2:\n            source = _context2.sent;\n            return _context2.delegateYield(_asyncGeneratorDelegate(_asyncIterator(source), _awaitAsyncGenerator), \"t0\", 4);\n          case 4:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2);\n    }))()\n  };\n}","map":{"version":3,"names":["defer","pair","deferred","piped","sink","_sink","_asyncToGenerator","_regeneratorRuntime","mark","_callee","source","wrap","_callee$","_context","prev","next","Error","resolve","stop","_x","apply","arguments","_wrapAsyncGenerator","_callee2","_callee2$","_context2","_awaitAsyncGenerator","promise","sent","delegateYield","_asyncGeneratorDelegate","_asyncIterator"],"sources":["/Users/apple/Documents/treasure/node_modules/it-pair/src/index.ts"],"sourcesContent":["import defer from 'p-defer'\nimport type { Source, Duplex } from 'it-stream-types'\n\n/**\n * A pair of streams where one drains from the other\n */\nexport function pair <T> (): Duplex<T> {\n  const deferred = defer<Source<T>>()\n  let piped = false\n\n  return {\n    sink: async source => {\n      if (piped) {\n        throw new Error('already piped')\n      }\n\n      piped = true\n      deferred.resolve(source)\n    },\n    source: (async function * () {\n      const source = await deferred.promise\n\n      yield * source\n    }())\n  }\n}\n"],"mappings":";;;;;;AAAA,OAAOA,KAAK,MAAM,SAAS;AAG3B;;;AAGA,OAAM,SAAUC,IAAIA,CAAA;EAClB,IAAMC,QAAQ,GAAGF,KAAK,EAAa;EACnC,IAAIG,KAAK,GAAG,KAAK;EAEjB,OAAO;IACLC,IAAI;MAAA,IAAAC,KAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAE,SAAAC,QAAMC,MAAM;QAAA,OAAAH,mBAAA,GAAAI,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cAAA,KACZZ,KAAK;gBAAAU,QAAA,CAAAE,IAAA;gBAAA;cAAA;cAAA,MACD,IAAIC,KAAK,CAAC,eAAe,CAAC;YAAA;cAGlCb,KAAK,GAAG,IAAI;cACZD,QAAQ,CAACe,OAAO,CAACP,MAAM,CAAC;YAAA;YAAA;cAAA,OAAAG,QAAA,CAAAK,IAAA;UAAA;QAAA,GAAAT,OAAA;MAAA,CACzB;MAAA,SAAAL,KAAAe,EAAA;QAAA,OAAAd,KAAA,CAAAe,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAAjB,IAAA;IAAA;IACDM,MAAM,EAAGY,mBAAA,eAAAf,mBAAA,GAAAC,IAAA,UAAAe,SAAA;MAAA,IAAAb,MAAA;MAAA,OAAAH,mBAAA,GAAAI,IAAA,UAAAa,UAAAC,SAAA;QAAA,kBAAAA,SAAA,CAAAX,IAAA,GAAAW,SAAA,CAAAV,IAAA;UAAA;YAAAU,SAAA,CAAAV,IAAA;YAAA,OAAAW,oBAAA,CACcxB,QAAQ,CAACyB,OAAO;UAAA;YAA/BjB,MAAM,GAAAe,SAAA,CAAAG,IAAA;YAEZ,OAAAH,SAAA,CAAAI,aAAA,CAAAC,uBAAA,CAAAC,cAAA,CAAQrB,MAAM,GAAAgB,oBAAA;UAAA;UAAA;YAAA,OAAAD,SAAA,CAAAP,IAAA;QAAA;MAAA,GAAAK,QAAA;IAAA,CACf;GACF;AACH"},"metadata":{},"sourceType":"module","externalDependencies":[]}