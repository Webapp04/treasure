{"ast":null,"code":"import pb from 'protobufjs';\nvar Writer = pb.Writer;\n// monkey patch the writer to add native bigint support\nvar methods = ['uint64', 'int64', 'sint64', 'fixed64', 'sfixed64'];\nmethods.forEach(function (method) {\n  // @ts-expect-error\n  var original = Writer.prototype[method];\n  // @ts-expect-error\n  Writer.prototype[method] = function (val) {\n    return original.call(this, val.toString());\n  };\n});\nexport function encodeMessage(message, codec) {\n  var w = Writer.create();\n  // @ts-expect-error\n  codec.encode(message, w, {\n    lengthDelimited: false\n  });\n  return w.finish();\n}","map":{"version":3,"names":["pb","Writer","methods","forEach","method","original","prototype","val","call","toString","encodeMessage","message","codec","w","create","encode","lengthDelimited","finish"],"sources":["/Users/apple/Documents/treasure/node_modules/protons-runtime/src/encode.ts"],"sourcesContent":["import type { Codec } from './codec.js'\nimport pb from 'protobufjs'\n\nconst Writer = pb.Writer\n\n// monkey patch the writer to add native bigint support\nconst methods = [\n  'uint64', 'int64', 'sint64', 'fixed64', 'sfixed64'\n]\nmethods.forEach(method => {\n  // @ts-expect-error\n  const original = Writer.prototype[method]\n  // @ts-expect-error\n  Writer.prototype[method] = function (val: bigint): pb.Writer {\n    return original.call(this, val.toString())\n  }\n})\n\nexport function encodeMessage <T> (message: T, codec: Codec<T>): Uint8Array {\n  const w = Writer.create()\n\n  // @ts-expect-error\n  codec.encode(message, w, {\n    lengthDelimited: false\n  })\n\n  return w.finish()\n}\n"],"mappings":"AACA,OAAOA,EAAE,MAAM,YAAY;AAE3B,IAAMC,MAAM,GAAGD,EAAE,CAACC,MAAM;AAExB;AACA,IAAMC,OAAO,GAAG,CACd,QAAQ,EAAE,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,UAAU,CACnD;AACDA,OAAO,CAACC,OAAO,CAAC,UAAAC,MAAM,EAAG;EACvB;EACA,IAAMC,QAAQ,GAAGJ,MAAM,CAACK,SAAS,CAACF,MAAM,CAAC;EACzC;EACAH,MAAM,CAACK,SAAS,CAACF,MAAM,CAAC,GAAG,UAAUG,GAAW;IAC9C,OAAOF,QAAQ,CAACG,IAAI,CAAC,IAAI,EAAED,GAAG,CAACE,QAAQ,EAAE,CAAC;EAC5C,CAAC;AACH,CAAC,CAAC;AAEF,OAAM,SAAUC,aAAaA,CAAMC,OAAU,EAAEC,KAAe;EAC5D,IAAMC,CAAC,GAAGZ,MAAM,CAACa,MAAM,EAAE;EAEzB;EACAF,KAAK,CAACG,MAAM,CAACJ,OAAO,EAAEE,CAAC,EAAE;IACvBG,eAAe,EAAE;GAClB,CAAC;EAEF,OAAOH,CAAC,CAACI,MAAM,EAAE;AACnB"},"metadata":{},"sourceType":"module","externalDependencies":[]}