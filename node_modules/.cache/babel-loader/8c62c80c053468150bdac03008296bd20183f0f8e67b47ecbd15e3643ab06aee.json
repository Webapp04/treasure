{"ast":null,"code":"import _regeneratorRuntime from\"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import AirdropApi from\"api/AirdropApi\";import{useContractDailyBonusRewardsWithSigner}from\"hooks/blockchain/useHandleContracts\";import useHandleNFT from\"hooks/blockchain/useHandleNFT\";import{useDispatch,useSelector}from\"react-redux\";import ACTIONS from\"redux/action\";import{selectNftList}from\"redux/slice/nftSlice\";import{selectUser}from\"redux/slice/userSlice\";import useGetKeyLevelBonusReward from\"./useGetKeyLevelBonusReward\";import useGetJlpSmrtBonusReward from\"./useGetJlpSmrtBonusReward\";import useGetJlpTresrBonusReward from\"./useGetJlpTresrBonusReward\";import useGetVeTresrBonusRewards from\"./useGetVeTresrBonusRewards\";import{ALERT_STATUS_FAILURE,ALERT_STATUS_SUCCESS,CLAIM_ALL_REWARDS_ALERT}from\"constant/alert\";export default function useClaimAll(){var nftLists=useSelector(selectNftList);var user=useSelector(selectUser);var dispatch=useDispatch();var handleNFT=useHandleNFT();var handleContractDailyBonusRewardsWithSigner=useContractDailyBonusRewardsWithSigner();var handleGetKeyLevelBonusReward=useGetKeyLevelBonusReward();var handleGetJlpSmrtBonusReward=useGetJlpSmrtBonusReward();var handleGetJlpTresrBonusReward=useGetJlpTresrBonusReward();var handleGetVeTresrBonusRewards=useGetVeTresrBonusRewards();var claimAll=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var _nftLists$filter,_nftLists$filter$filt;var ownTokenList,contractDailyBonusRewardsWithSigner;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(user!==null&&user!==void 0&&user.wallet_id){_context2.next=2;break;}return _context2.abrupt(\"return\");case 2:ownTokenList=nftLists===null||nftLists===void 0?void 0:(_nftLists$filter=nftLists.filter(function(item){return(item===null||item===void 0?void 0:item.owner)===(user===null||user===void 0?void 0:user.wallet_id);}))===null||_nftLists$filter===void 0?void 0:(_nftLists$filter$filt=_nftLists$filter.filter(function(item){return(item===null||item===void 0?void 0:item.staked)==true;}))===null||_nftLists$filter$filt===void 0?void 0:_nftLists$filter$filt.map(function(item){return+(item===null||item===void 0?void 0:item.tokenId);});_context2.next=5;return handleContractDailyBonusRewardsWithSigner;case 5:contractDailyBonusRewardsWithSigner=_context2.sent;return _context2.abrupt(\"return\",contractDailyBonusRewardsWithSigner.claimAll(ownTokenList).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(tx){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:new AirdropApi().logger({wallet_id:user===null||user===void 0?void 0:user.wallet_id,type:\"PENDING\",action:\"claimAll\",description:\"Claimed all\",tx:JSON.stringify(tx)});_context.next=3;return tx.wait();case 3:ACTIONS.SET_TRANSANCTION_HASH(dispatch,tx===null||tx===void 0?void 0:tx.hash);// await sleep(15);\nhandleNFT.getRewardsReleased();handleNFT.balanceOfTRESR(user===null||user===void 0?void 0:user.wallet_id);handleNFT.getAVAXBalance(user===null||user===void 0?void 0:user.wallet_id);handleNFT.getBonusPoolAllocation();handleNFT.getPoolAllocation();handleNFT.getTresrRewardsBalance();handleGetKeyLevelBonusReward.getKeyLevelBonusReward();handleGetJlpSmrtBonusReward.getJlpSmrtBonusReward();handleGetJlpTresrBonusReward.getJlpTresrBonusReward();handleGetVeTresrBonusRewards.getVeTresrBonusReward();ACTIONS.SET_ALERT(dispatch,true,ALERT_STATUS_SUCCESS,CLAIM_ALL_REWARDS_ALERT(true));case 15:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}()).catch(function(err){new AirdropApi().logger({wallet_id:user===null||user===void 0?void 0:user.wallet_id,type:\"ERROR\",action:\"claimAll\",description:\"Claimed all\",error:JSON.stringify(err)});ACTIONS.SET_ALERT(dispatch,true,ALERT_STATUS_FAILURE,CLAIM_ALL_REWARDS_ALERT(false));return null;}));case 7:case\"end\":return _context2.stop();}},_callee2);}));return function claimAll(){return _ref.apply(this,arguments);};}();return{claimAll:claimAll};}","map":{"version":3,"names":["AirdropApi","useContractDailyBonusRewardsWithSigner","useHandleNFT","useDispatch","useSelector","ACTIONS","selectNftList","selectUser","useGetKeyLevelBonusReward","useGetJlpSmrtBonusReward","useGetJlpTresrBonusReward","useGetVeTresrBonusRewards","ALERT_STATUS_FAILURE","ALERT_STATUS_SUCCESS","CLAIM_ALL_REWARDS_ALERT","useClaimAll","nftLists","user","dispatch","handleNFT","handleContractDailyBonusRewardsWithSigner","handleGetKeyLevelBonusReward","handleGetJlpSmrtBonusReward","handleGetJlpTresrBonusReward","handleGetVeTresrBonusRewards","claimAll","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","_nftLists$filter","_nftLists$filter$filt","ownTokenList","contractDailyBonusRewardsWithSigner","wrap","_callee2$","_context2","prev","next","wallet_id","abrupt","filter","item","owner","staked","map","tokenId","sent","then","_ref2","_callee","tx","_callee$","_context","logger","type","action","description","JSON","stringify","wait","SET_TRANSANCTION_HASH","hash","getRewardsReleased","balanceOfTRESR","getAVAXBalance","getBonusPoolAllocation","getPoolAllocation","getTresrRewardsBalance","getKeyLevelBonusReward","getJlpSmrtBonusReward","getJlpTresrBonusReward","getVeTresrBonusReward","SET_ALERT","stop","_x","apply","arguments","catch","err","error"],"sources":["/Users/apple/Documents/treasure/src/hooks/rewards/useClaimAll.js"],"sourcesContent":["import AirdropApi from \"api/AirdropApi\";\nimport { useContractDailyBonusRewardsWithSigner } from \"hooks/blockchain/useHandleContracts\";\nimport useHandleNFT from \"hooks/blockchain/useHandleNFT\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport ACTIONS from \"redux/action\";\nimport { selectNftList } from \"redux/slice/nftSlice\";\nimport { selectUser } from \"redux/slice/userSlice\";\nimport useGetKeyLevelBonusReward from \"./useGetKeyLevelBonusReward\";\nimport useGetJlpSmrtBonusReward from \"./useGetJlpSmrtBonusReward\";\nimport useGetJlpTresrBonusReward from \"./useGetJlpTresrBonusReward\";\nimport useGetVeTresrBonusRewards from \"./useGetVeTresrBonusRewards\";\nimport {\n  ALERT_STATUS_FAILURE,\n  ALERT_STATUS_SUCCESS,\n  CLAIM_ALL_REWARDS_ALERT,\n} from \"constant/alert\";\n\nexport default function useClaimAll() {\n  const nftLists = useSelector(selectNftList);\n  const user = useSelector(selectUser);\n  const dispatch = useDispatch();\n  const handleNFT = useHandleNFT();\n  const handleContractDailyBonusRewardsWithSigner =\n    useContractDailyBonusRewardsWithSigner();\n  const handleGetKeyLevelBonusReward = useGetKeyLevelBonusReward();\n  const handleGetJlpSmrtBonusReward = useGetJlpSmrtBonusReward();\n  const handleGetJlpTresrBonusReward = useGetJlpTresrBonusReward();\n  const handleGetVeTresrBonusRewards = useGetVeTresrBonusRewards();\n\n  const claimAll = async () => {\n    if (!user?.wallet_id) return;\n\n    const ownTokenList = nftLists\n      ?.filter((item) => item?.owner === user?.wallet_id)\n      ?.filter((item) => item?.staked == true)\n      ?.map((item) => +item?.tokenId);\n    const contractDailyBonusRewardsWithSigner =\n      await handleContractDailyBonusRewardsWithSigner;\n    return contractDailyBonusRewardsWithSigner\n      .claimAll(ownTokenList)\n      .then(async (tx) => {\n        new AirdropApi().logger({\n          wallet_id: user?.wallet_id,\n          type: \"PENDING\",\n          action: \"claimAll\",\n          description: `Claimed all`,\n          tx: JSON.stringify(tx),\n        });\n        await tx.wait();\n        ACTIONS.SET_TRANSANCTION_HASH(dispatch, tx?.hash);\n        // await sleep(15);\n        handleNFT.getRewardsReleased();\n        handleNFT.balanceOfTRESR(user?.wallet_id);\n        handleNFT.getAVAXBalance(user?.wallet_id);\n        handleNFT.getBonusPoolAllocation();\n        handleNFT.getPoolAllocation();\n        handleNFT.getTresrRewardsBalance();\n        handleGetKeyLevelBonusReward.getKeyLevelBonusReward();\n        handleGetJlpSmrtBonusReward.getJlpSmrtBonusReward();\n        handleGetJlpTresrBonusReward.getJlpTresrBonusReward();\n        handleGetVeTresrBonusRewards.getVeTresrBonusReward();\n        ACTIONS.SET_ALERT(\n          dispatch,\n          true,\n          ALERT_STATUS_SUCCESS,\n          CLAIM_ALL_REWARDS_ALERT(true)\n        );\n      })\n      .catch((err) => {\n        new AirdropApi().logger({\n          wallet_id: user?.wallet_id,\n          type: \"ERROR\",\n          action: \"claimAll\",\n          description: `Claimed all`,\n          error: JSON.stringify(err),\n        });\n        ACTIONS.SET_ALERT(\n          dispatch,\n          true,\n          ALERT_STATUS_FAILURE,\n          CLAIM_ALL_REWARDS_ALERT(false)\n        );\n        return null;\n      });\n  };\n  return { claimAll };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}