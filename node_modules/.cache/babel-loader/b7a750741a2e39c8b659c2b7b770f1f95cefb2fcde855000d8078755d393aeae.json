{"ast":null,"code":"'use strict';\n\nvar _classCallCheck = require(\"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\nvar _createClass = require(\"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/createClass.js\").default;\nvar getTime = require('./time');\nvar Retimer = /*#__PURE__*/function () {\n  function Retimer(callback, timeout, args) {\n    _classCallCheck(this, Retimer);\n    var that = this;\n    this._started = getTime();\n    this._rescheduled = 0;\n    this._scheduled = timeout;\n    this._args = args;\n    this._triggered = false;\n    this._timerWrapper = function () {\n      if (that._rescheduled > 0) {\n        that._scheduled = that._rescheduled - (getTime() - that._started);\n        that._schedule(that._scheduled);\n      } else {\n        that._triggered = true;\n        callback.apply(null, that._args);\n      }\n    };\n    this._timer = setTimeout(this._timerWrapper, timeout);\n  }\n  _createClass(Retimer, [{\n    key: \"reschedule\",\n    value: function reschedule(timeout) {\n      if (!timeout) {\n        timeout = this._scheduled;\n      }\n      var now = getTime();\n      if (now + timeout - (this._started + this._scheduled) < 0) {\n        clearTimeout(this._timer);\n        this._schedule(timeout);\n      } else if (!this._triggered) {\n        this._started = now;\n        this._rescheduled = timeout;\n      } else {\n        this._schedule(timeout);\n      }\n    }\n  }, {\n    key: \"_schedule\",\n    value: function _schedule(timeout) {\n      this._triggered = false;\n      this._started = getTime();\n      this._rescheduled = 0;\n      this._scheduled = timeout;\n      this._timer = setTimeout(this._timerWrapper, timeout);\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      clearTimeout(this._timer);\n    }\n  }]);\n  return Retimer;\n}();\nfunction retimer() {\n  if (typeof arguments[0] !== 'function') {\n    throw new Error('callback needed');\n  }\n  if (typeof arguments[1] !== 'number') {\n    throw new Error('timeout needed');\n  }\n  var args;\n  if (arguments.length > 0) {\n    args = new Array(arguments.length - 2);\n\n    /* eslint-disable no-var */\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i + 2];\n    }\n  }\n  return new Retimer(arguments[0], arguments[1], args);\n}\nmodule.exports = retimer;","map":{"version":3,"names":["_classCallCheck","require","default","_createClass","getTime","Retimer","callback","timeout","args","that","_started","_rescheduled","_scheduled","_args","_triggered","_timerWrapper","_schedule","apply","_timer","setTimeout","key","value","reschedule","now","clearTimeout","clear","retimer","arguments","Error","length","Array","i","module","exports"],"sources":["/Users/apple/Documents/treasure/node_modules/retimer/retimer.js"],"sourcesContent":["'use strict'\n\nconst getTime = require('./time')\n\nclass Retimer {\n  constructor (callback, timeout, args) {\n    const that = this\n\n    this._started = getTime()\n    this._rescheduled = 0\n    this._scheduled = timeout\n    this._args = args\n    this._triggered = false\n\n    this._timerWrapper = () => {\n      if (that._rescheduled > 0) {\n        that._scheduled = that._rescheduled - (getTime() - that._started)\n        that._schedule(that._scheduled)\n      } else {\n        that._triggered = true\n        callback.apply(null, that._args)\n      }\n    }\n\n    this._timer = setTimeout(this._timerWrapper, timeout)\n  }\n\n  reschedule (timeout) {\n    if (!timeout) {\n      timeout = this._scheduled\n    }\n    const now = getTime()\n    if ((now + timeout) - (this._started + this._scheduled) < 0) {\n      clearTimeout(this._timer)\n      this._schedule(timeout)\n    } else if (!this._triggered) {\n      this._started = now\n      this._rescheduled = timeout\n    } else {\n      this._schedule(timeout)\n    }\n  }\n\n  _schedule (timeout) {\n    this._triggered = false\n    this._started = getTime()\n    this._rescheduled = 0\n    this._scheduled = timeout\n    this._timer = setTimeout(this._timerWrapper, timeout)\n  }\n\n  clear () {\n    clearTimeout(this._timer)\n  }\n}\n\nfunction retimer () {\n  if (typeof arguments[0] !== 'function') {\n    throw new Error('callback needed')\n  }\n\n  if (typeof arguments[1] !== 'number') {\n    throw new Error('timeout needed')\n  }\n\n  let args\n\n  if (arguments.length > 0) {\n    args = new Array(arguments.length - 2)\n\n    /* eslint-disable no-var */\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i + 2]\n    }\n  }\n\n  return new Retimer(arguments[0], arguments[1], args)\n}\n\nmodule.exports = retimer\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}