{"ast":null,"code":"import _regeneratorRuntime from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/apple/Documents/treasure/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { withTimeoutOption } from 'ipfs-core-utils/with-timeout-option';\nimport first from 'it-first';\nimport last from 'it-last';\nimport { resolve } from '../../utils.js';\nimport errCode from 'err-code';\n\n/**\n * @param {object} config\n * @param {import('ipfs-core-utils/multicodecs').Multicodecs} config.codecs\n * @param {import('ipfs-repo').IPFSRepo} config.repo\n * @param {import('../../types').Preload} config.preload\n */\nexport function createGet(_ref) {\n  var codecs = _ref.codecs,\n    repo = _ref.repo,\n    preload = _ref.preload;\n  /**\n   * @type {import('ipfs-core-types/src/dag').API<{}>[\"get\"]}\n   */\n  var get = /*#__PURE__*/function () {\n    var _get = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(cid) {\n      var options,\n        entry,\n        result,\n        codec,\n        block,\n        node,\n        _args = arguments;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};\n            if (options.preload !== false) {\n              preload(cid);\n            }\n            if (!options.path) {\n              _context.next = 17;\n              break;\n            }\n            if (!options.localResolve) {\n              _context.next = 9;\n              break;\n            }\n            _context.next = 6;\n            return first(resolve(cid, options.path, codecs, repo, options));\n          case 6:\n            _context.t0 = _context.sent;\n            _context.next = 12;\n            break;\n          case 9:\n            _context.next = 11;\n            return last(resolve(cid, options.path, codecs, repo, options));\n          case 11:\n            _context.t0 = _context.sent;\n          case 12:\n            entry = _context.t0;\n            /** @type {import('ipfs-core-types/src/dag').GetResult | undefined} - first and last will return undefined when empty */\n            result = entry;\n            if (result) {\n              _context.next = 16;\n              break;\n            }\n            throw errCode(new Error('Not found'), 'ERR_NOT_FOUND');\n          case 16:\n            return _context.abrupt(\"return\", result);\n          case 17:\n            _context.next = 19;\n            return codecs.getCodec(cid.code);\n          case 19:\n            codec = _context.sent;\n            _context.next = 22;\n            return repo.blocks.get(cid, options);\n          case 22:\n            block = _context.sent;\n            node = codec.decode(block);\n            return _context.abrupt(\"return\", {\n              value: node,\n              remainderPath: ''\n            });\n          case 25:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }));\n    function get(_x) {\n      return _get.apply(this, arguments);\n    }\n    return get;\n  }();\n  return withTimeoutOption(get);\n}","map":{"version":3,"names":["withTimeoutOption","first","last","resolve","errCode","createGet","_ref","codecs","repo","preload","get","_get","_asyncToGenerator","_regeneratorRuntime","mark","_callee","cid","options","entry","result","codec","block","node","_args","arguments","wrap","_callee$","_context","prev","next","length","undefined","path","localResolve","t0","sent","Error","abrupt","getCodec","code","blocks","decode","value","remainderPath","stop","_x","apply"],"sources":["/Users/apple/Documents/treasure/node_modules/ipfs-core/src/components/dag/get.js"],"sourcesContent":["import { withTimeoutOption } from 'ipfs-core-utils/with-timeout-option'\nimport first from 'it-first'\nimport last from 'it-last'\nimport { resolve } from '../../utils.js'\nimport errCode from 'err-code'\n\n/**\n * @param {object} config\n * @param {import('ipfs-core-utils/multicodecs').Multicodecs} config.codecs\n * @param {import('ipfs-repo').IPFSRepo} config.repo\n * @param {import('../../types').Preload} config.preload\n */\nexport function createGet ({ codecs, repo, preload }) {\n  /**\n   * @type {import('ipfs-core-types/src/dag').API<{}>[\"get\"]}\n   */\n  const get = async function get (cid, options = {}) {\n    if (options.preload !== false) {\n      preload(cid)\n    }\n\n    if (options.path) {\n      const entry = options.localResolve\n        ? await first(resolve(cid, options.path, codecs, repo, options))\n        : await last(resolve(cid, options.path, codecs, repo, options))\n      /** @type {import('ipfs-core-types/src/dag').GetResult | undefined} - first and last will return undefined when empty */\n      const result = (entry)\n\n      if (!result) {\n        throw errCode(new Error('Not found'), 'ERR_NOT_FOUND')\n      }\n\n      return result\n    }\n\n    const codec = await codecs.getCodec(cid.code)\n    const block = await repo.blocks.get(cid, options)\n    const node = codec.decode(block)\n\n    return {\n      value: node,\n      remainderPath: ''\n    }\n  }\n\n  return withTimeoutOption(get)\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}